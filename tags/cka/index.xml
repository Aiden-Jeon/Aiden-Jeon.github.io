<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cka on Aiden's Camp</title><link>https://aiden-jeon.github.io/blog/tags/cka/</link><description>Recent content in Cka on Aiden's Camp</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 28 Jun 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://aiden-jeon.github.io/blog/tags/cka/index.xml" rel="self" type="application/rss+xml"/><item><title>(CKA) CKA 합격 후기</title><link>https://aiden-jeon.github.io/blog/p/cka-cka-%ED%95%A9%EA%B2%A9-%ED%9B%84%EA%B8%B0/</link><pubDate>Mon, 28 Jun 2021 00:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-cka-%ED%95%A9%EA%B2%A9-%ED%9B%84%EA%B8%B0/</guid><description>&lt;h2 id="준비-과정">&lt;a href="#%ec%a4%80%eb%b9%84-%ea%b3%bc%ec%a0%95" class="header-anchor">&lt;/a>준비 과정
&lt;/h2>&lt;p>앞선 포스팅에도 나와 있지만 저는 Udemy의 CKA 강의를 들으며 준비했습니다. &lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의 링크&lt;/a>&lt;/p>
&lt;p>준비 기간은 2달이 걸렸습니다. 강의 듣고 요약 + Practice Test를 총 한 바퀴 돌렸습니다.
시험 1주전에는 실제 시험에서 사용할 수 있도록 Kuberenetes Document만 보면서 다시 Practice Test를 한 바퀴 더 돌렸습니다.
시험 과정에서 공식 문서의 즐겨찾기는 사용 가능합니다. 그래서 저는 두 번째 볼 때 제가 바로 찾아 볼 수 있도록 제목으로 저장했습니다.&lt;/p>
&lt;p>아래는 제가 사용했었던 즐겨찾기 입니다.&lt;/p>
&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/review_01.png"
loading="lazy"
alt="즐겨찾기"
>&lt;/p>
&lt;h2 id="시험-내용">&lt;a href="#%ec%8b%9c%ed%97%98-%eb%82%b4%ec%9a%a9" class="header-anchor">&lt;/a>시험 내용
&lt;/h2>&lt;p>CKA 시험은 v1.19 를 기준으로 2시간 17문제로 개편되었으며, 개편된 합격 기준은 66점입니다.
다른 후기를 찾아 보실 때 참고하시면 좋을 것 같습니다.&lt;/p>
&lt;p>시험이 시작하면 감독이 입장합니다. 이 때 감독관과 나누는 모든 대화는 채팅으로 이루어집니다.
감독관이 들어오면 제일 처음 신분증을 요구하는데 저는 여권을 보여주었습니다.
다른 후기들을 보니 여권이 없다면 신용카드 + 주민등록증으로도 가능한 것 같습니다.&lt;/p>
&lt;p>신분증 확인 후에는 시험보는 곳에 대해서 보여달라고 합니다. 4방향의 벽, 책상과 책상 밑을 확인합니다.
저는 노트북 스탠드, 키보드와 마우스를 따로 챙겨가서 아래 부분도 다 보여주었습니다.&lt;/p>
&lt;p>이 과정은 실제 시험시간에 포함되지 않으며 이 과정이 끝나면 시험 시작 버튼이 활성화되는데 이 때 부터 2시간입니다.
다만 정확히 몇 분이 남았는지 보여주는 것이 아니라 Progress bar로 표시되서 남은 시간을 정확히 알 수 없었습니다.
시험시작 할 때의 시간을 알아둔다면 시간 조절에 더 좋을 것 같습니다.
저는 약 30분 정도 남기고 마무리를 지었습니다.&lt;/p>
&lt;h2 id="시험-문제-유형">&lt;a href="#%ec%8b%9c%ed%97%98-%eb%ac%b8%ec%a0%9c-%ec%9c%a0%ed%98%95" class="header-anchor">&lt;/a>시험 문제 유형
&lt;/h2>&lt;p>시험은 Udemy Practice Test와 거의 유사하게 나옵니다. 다른 후기들과 비교해보면 아래 유형들은 꼭 나오는 것 같습니다.&lt;/p>
&lt;ul>
&lt;li>ETCD Save &amp;amp; Restore&lt;/li>
&lt;li>Upgrade Kubeadm&lt;/li>
&lt;li>Fix Node&lt;/li>
&lt;/ul>
&lt;p>그 외에는 Pod 생성 문제들이 많았습니다.&lt;/p>
&lt;ul>
&lt;li>Multi pod&lt;/li>
&lt;li>Sidecar&lt;/li>
&lt;li>Mount PVC&lt;/li>
&lt;li>Expose&lt;/li>
&lt;/ul>
&lt;p>제일 어려웠던 부분은 Networking관련 문제들이였습니다.
Practice Test와 다르게 맞았는지 틀렸는지 바로 확인할 수 없기 때문에 확신이 없었습니다.
Udemy Solution에서 다른 팟을 이용해 네트워킹의 동작 여부를 확인하는 방법이 있었는데 이 부분을 집중해서 보지 않았던게 아쉬웠습니다.&lt;/p>
&lt;p>그 외에 당황스러운건 ServiceAccount 문제였습니다.
강의에선 그냥 넘어 가고 Mock Exam 3에서만 나왔던 것 같은데 다행히 시험 전에 손 풀 겸 다시 봐서 풀 수 있었습니다.&lt;/p>
&lt;h2 id="마치며">&lt;a href="#%eb%a7%88%ec%b9%98%eb%a9%b0" class="header-anchor">&lt;/a>마치며
&lt;/h2>&lt;p>저는 89점으로 시험에 합격했습니다. 준비를 하면서 Kubernetes에 대해서 많이 알게 된 것 같습니다.
다만 개념을 아는 것과 시험문제를 푸는 것은 다르다는 것을 또다시 느낄 수 있었습니다.
자격증이 목표라면 개념보다는 Practice Test를 위주로 본다면 한 달 정도면 충분 할 것 같습니다.&lt;/p>
&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/review_02.png"
loading="lazy"
alt="CKA"
>&lt;/p></description></item><item><title>(CKA) 09. Design and Install a k8s Cluster</title><link>https://aiden-jeon.github.io/blog/p/cka-09.-design-and-install-a-k8s-cluster/</link><pubDate>Mon, 07 Jun 2021 00:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-09.-design-and-install-a-k8s-cluster/</guid><description>&lt;p>CKA를 준비하면서 공부한 요약 내용입니다.&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener"
>What is CKA?&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="design-a-k8s-cluster">&lt;a href="#design-a-k8s-cluster" class="header-anchor">&lt;/a>Design a k8s cluster
&lt;/h2>&lt;h3 id="purpose">&lt;a href="#purpose" class="header-anchor">&lt;/a>Purpose
&lt;/h3>&lt;ul>
&lt;li>Education
&lt;ul>
&lt;li>Minikube&lt;/li>
&lt;li>Single node cluster w\ kubeadm/GCP/A&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Development &amp;amp; Testing
&lt;ul>
&lt;li>Multi-node cluster with a single master and multiple workers&lt;/li>
&lt;li>setup using kbeadm tool or quick provision on GCP or AWS or AKS&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Hosting Production Applications&lt;/li>
&lt;/ul>
&lt;h4 id="hosting-production-applications">&lt;a href="#hosting-production-applications" class="header-anchor">&lt;/a>Hosting Production Applications
&lt;/h4>&lt;ul>
&lt;li>High Availability Multi node cluster with multiple master nodes&lt;/li>
&lt;li>kubeadm or GCP or Kops on AWS or other supported platforms&lt;/li>
&lt;li>Upto 5000 nodes&lt;/li>
&lt;li>Upto 150,000 PODs in the cluster&lt;/li>
&lt;li>Upto 300,000 Total Containers&lt;/li>
&lt;li>Upto 100 PODs per Node&lt;/li>
&lt;/ul>
&lt;h3 id="cloud-or-onprem">&lt;a href="#cloud-or-onprem" class="header-anchor">&lt;/a>Cloud or OnPrem
&lt;/h3>&lt;ul>
&lt;li>Use Kubeadm for on-prem&lt;/li>
&lt;li>GKE for GCP&lt;/li>
&lt;li>Kops for AWS&lt;/li>
&lt;li>AKS for Azure&lt;/li>
&lt;/ul>
&lt;h3 id="storage">&lt;a href="#storage" class="header-anchor">&lt;/a>Storage
&lt;/h3>&lt;ul>
&lt;li>High Performance - SSD Backed Storage&lt;/li>
&lt;li>Multiple Concurrent connections - Network based storage&lt;/li>
&lt;li>Persistent shared volumes for shared access across multiple PODs&lt;/li>
&lt;li>Label nodes with specific disk types&lt;/li>
&lt;li>Use Node Selectors to assign applications to nodes with specific disk types&lt;/li>
&lt;/ul>
&lt;h3 id="nodes">&lt;a href="#nodes" class="header-anchor">&lt;/a>Nodes
&lt;/h3>&lt;ul>
&lt;li>Virtual or Physical Machines&lt;/li>
&lt;li>Minimum of 4 Node cluster&lt;/li>
&lt;li>Master vs Worker Nodes&lt;/li>
&lt;li>Linux X86_64 Architecture&lt;/li>
&lt;li>Master nodes can host worloads&lt;/li>
&lt;li>Best practice is to not host workloads on Master nodes&lt;/li>
&lt;/ul>
&lt;h2 id="etcd-in-ha">&lt;a href="#etcd-in-ha" class="header-anchor">&lt;/a>ETCD in HA
&lt;/h2>&lt;h3 id="etcd">&lt;a href="#etcd" class="header-anchor">&lt;/a>ETCD
&lt;/h3>&lt;ul>
&lt;li>a distributed reliable key-value store that is Simple, Secure &amp;amp; Fast&lt;/li>
&lt;/ul>
&lt;h4 id="key-value-store">&lt;a href="#key-value-store" class="header-anchor">&lt;/a>Key-value store
&lt;/h4>&lt;ul>
&lt;li>Tablular/Relational Databases
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/design-1.png"
loading="lazy"
alt="tabular-table"
>&lt;/li>
&lt;li>key-value store
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/design-2.png"
loading="lazy"
alt="key-value"
>&lt;/li>
&lt;/ul>
&lt;h4 id="distributed">&lt;a href="#distributed" class="header-anchor">&lt;/a>Distributed
&lt;/h4>&lt;ul>
&lt;li>it is possible to have your database across multiple servers&lt;/li>
&lt;/ul>
&lt;h4 id="consistent">&lt;a href="#consistent" class="header-anchor">&lt;/a>Consistent
&lt;/h4>&lt;ul>
&lt;li>how does it ensure the data on all the nodes are consitent?
&lt;ul>
&lt;li>ETCD ensures that the same consistent copy of the data is available on all instances at the same time&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>how does do that?
&lt;ul>
&lt;li>read ← easy&lt;/li>
&lt;li>write
&lt;ul>
&lt;li>two write request coming&lt;/li>
&lt;li>only one of the instances is responsible for processing the writes&lt;/li>
&lt;li>interanally the other nodes elect a leader among them.
&lt;ul>
&lt;li>one node: leader&lt;/li>
&lt;li>other nodes: followers&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>leader process write
&lt;ul>
&lt;li>leader makes sure that the other nodes are sent a copy of the data&lt;/li>
&lt;li>if the writes come in through any of the other follower nodes, then they forward the wirtes to the leader internally&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="leader-election---raft">&lt;a href="#leader-election---raft" class="header-anchor">&lt;/a>Leader Election - RAFT
&lt;/h3>&lt;ul>
&lt;li>How to elect leader in ETCD&lt;/li>
&lt;li>→ use RAFT protocol&lt;/li>
&lt;/ul>
&lt;h4 id="방법">&lt;a href="#%eb%b0%a9%eb%b2%95" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;ul>
&lt;li>use RAFT Algorithm
&lt;ol>
&lt;li>random timers for initiating requets&lt;/li>
&lt;li>first nodes sent out a requetst to the otehr node requesting permission to be the leader&lt;/li>
&lt;li>other managers receiving the request responds with their vote and node assumens the leader role&lt;/li>
&lt;li>leader is elected, it sends out notifications at regular intervals to other masters informing them that it is continuing to assume the roloe of the leader&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>other nodes do not receive a notifications from the leader at some point time
&lt;ol>
&lt;li>nodes initiate a re-election process among themselves&lt;/li>
&lt;li>new leader is identified&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul></description></item><item><title>(CKA) 08. Networking</title><link>https://aiden-jeon.github.io/blog/p/cka-08.-networking/</link><pubDate>Sun, 06 Jun 2021 00:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-08.-networking/</guid><description>&lt;p>CKA를 준비하면서 공부한 요약 내용입니다.&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener"
>What is CKA?&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="pod-networking">&lt;a href="#pod-networking" class="header-anchor">&lt;/a>POD Networking
&lt;/h2>&lt;ul>
&lt;li>Every POD should have and IP Address&lt;/li>
&lt;li>Every POD should be able to communicate with every other POD in the same node&lt;/li>
&lt;li>Every POD should be able to communicate with every other POD on other nodes without NAT&lt;/li>
&lt;/ul>
&lt;h2 id="cni-in-kubernetes">&lt;a href="#cni-in-kubernetes" class="header-anchor">&lt;/a>CNI in kubernetes
&lt;/h2>&lt;h3 id="configuring-cni">&lt;a href="#configuring-cni" class="header-anchor">&lt;/a>Configuring CNI
&lt;/h3>&lt;ul>
&lt;li>kubelete.service&lt;/li>
&lt;li>&lt;code>ps -aux | grep kubelet&lt;/code>
&lt;ul>
&lt;li>&lt;code>--cni-conf-dir=/etc/cni/net.d&lt;/code>&lt;/li>
&lt;li>&lt;code>ls /opt/cni/bin&lt;/code>&lt;/li>
&lt;li>&lt;code>ls /etc/cni/net.d&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="cni-weaveworks">&lt;a href="#cni-weaveworks" class="header-anchor">&lt;/a>CNI WeaveWorks
&lt;/h2>&lt;h3 id="script">&lt;a href="#script" class="header-anchor">&lt;/a>Script
&lt;/h3>&lt;p>Networking solution has a routing table which mapped what networks are on what hosts&lt;/p>
&lt;ul>
&lt;li>when a packet is sent from pod to the other, it goes out
&lt;ul>
&lt;li>to the network,&lt;/li>
&lt;li>to the router,&lt;/li>
&lt;li>find its way to the node that hosts that pod
→ works for a small environment and in a simple network
→ Larger environment, this is not practical&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>routing table may not support so many entries&lt;/li>
&lt;/ul>
&lt;h3 id="weaveworks">&lt;a href="#weaveworks" class="header-anchor">&lt;/a>WeaveWorks
&lt;/h3>&lt;ul>
&lt;li>deply an agent or service on each node&lt;/li>
&lt;li>they communicate with each other to exchange information withing them
&lt;ul>
&lt;li>nodes&lt;/li>
&lt;li>networks&lt;/li>
&lt;li>PODs&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="how-it-works">&lt;a href="#how-it-works" class="header-anchor">&lt;/a>How it works
&lt;/h4>&lt;ul>
&lt;li>Send
&lt;ol>
&lt;li>a packet is sent from one pod to another on another node&lt;/li>
&lt;li>weave intercepts the packet and identifies that it&amp;rsquo;s on a seperate network&lt;/li>
&lt;li>encapsulates this packet into a new one with new source and destination&lt;/li>
&lt;li>sends it across the network&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Recieve
&lt;ul>
&lt;li>other weave agent retrieves the packet&lt;/li>
&lt;li>decapsulates&lt;/li>
&lt;li>routes the packet to the right pod&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="deploy">&lt;a href="#deploy" class="header-anchor">&lt;/a>Deploy
&lt;/h4>&lt;ul>
&lt;li>weave and weave peers
&lt;ul>
&lt;li>deployed as service or daemons on each node&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>kubectl apply -f &amp;quot;&amp;lt;https://cloud.weave.works/k8s/net?k8s-version=$&amp;gt;(kubectl version | base64 | tr -d '\\n')&amp;quot;&lt;/code>
&lt;ul>
&lt;li>deploys daemonset&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="상태">&lt;a href="#%ec%83%81%ed%83%9c" class="header-anchor">&lt;/a>상태
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubectl get pods -n kubesystem | grep weave-net&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="ip-adress-management">&lt;a href="#ip-adress-management" class="header-anchor">&lt;/a>IP Adress Management
&lt;/h2>&lt;ul>
&lt;li>how the tool brutes networks&lt;/li>
&lt;li>the nodes assign an IP subset&lt;/li>
&lt;li>how are the pods assigned an IP&lt;/li>
&lt;li>where is this information stored&lt;/li>
&lt;li>who is responsible for ensuring there are no duplicate IP is assigned&lt;/li>
&lt;/ul>
&lt;h3 id="script-1">&lt;a href="#script-1" class="header-anchor">&lt;/a>Script
&lt;/h3>&lt;h4 id="who">&lt;a href="#who" class="header-anchor">&lt;/a>Who
&lt;/h4>&lt;ul>
&lt;li>CNI
&lt;ul>
&lt;li>who define the standards CNI&lt;/li>
&lt;li>it is responsibility of the CNI plugin, the network provider to take care of assigning IP to the containers&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="how">&lt;a href="#how" class="header-anchor">&lt;/a>How
&lt;/h4>&lt;ul>
&lt;li>get free IP list from file
&lt;ul>
&lt;li>placed on the each host&lt;/li>
&lt;li>&lt;code>ip = get_free_ip_from_host_local()&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>cat /etc/cni/net.d/net-script.conf&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;#34;ipam&amp;#34;: &lt;/span>{&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">&amp;#34;type&amp;#34;: &lt;/span>&lt;span class="l">...,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">&amp;#34;subnet&amp;#34;: &lt;/span>&lt;span class="l">...,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">&amp;#34;routes&amp;#34;: &lt;/span>&lt;span class="l">...,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>}&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="weaveworks-1">&lt;a href="#weaveworks-1" class="header-anchor">&lt;/a>WeaveWorks
&lt;/h3>&lt;ul>
&lt;li>entire network
&lt;ul>
&lt;li>10.32.0.0/12&lt;/li>
&lt;li>10.32.0.1 ~ 10.47.255.254&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="service-networking">&lt;a href="#service-networking" class="header-anchor">&lt;/a>Service Networking
&lt;/h2>&lt;h3 id="type-of-service">&lt;a href="#type-of-service" class="header-anchor">&lt;/a>Type of service
&lt;/h3>&lt;h4 id="cluster-ip">&lt;a href="#cluster-ip" class="header-anchor">&lt;/a>Cluster IP
&lt;/h4>&lt;ul>
&lt;li>if created it is accessible from all pods of the cluster, irrespective of what nodes the pods are on&lt;/li>
&lt;li>hosted across the cluster&lt;/li>
&lt;li>only aceescible from within ther cluster&lt;/li>
&lt;/ul>
&lt;h4 id="nodeport">&lt;a href="#nodeport" class="header-anchor">&lt;/a>NodePort
&lt;/h4>&lt;ul>
&lt;li>works as cluster IP&lt;/li>
&lt;li>in addtion, it also exposes the applications on a port on all nodes in ther cluster
&lt;ul>
&lt;li>external user or applications have access to the service&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="question">&lt;a href="#question" class="header-anchor">&lt;/a>Question
&lt;/h3>&lt;ul>
&lt;li>How are the services getting these IP addresses&lt;/li>
&lt;li>How are they made avaliable acorss all the nodes in the cluster&lt;/li>
&lt;li>How is service made avalible to external users through a port on each node&lt;/li>
&lt;li>Who is doing that, and how and where do we see it&lt;/li>
&lt;/ul>
&lt;h3 id="answer">&lt;a href="#answer" class="header-anchor">&lt;/a>Answer
&lt;/h3>&lt;h4 id="kubelet-process">&lt;a href="#kubelet-process" class="header-anchor">&lt;/a>kubelet process
&lt;/h4>&lt;ul>
&lt;li>which is responsible for creating PODs&lt;/li>
&lt;li>each kubelet service on each node&lt;/li>
&lt;li>whatches the changes in the cluster through the kube-api server
&lt;ol>
&lt;li>everty time a new pod is to be created, it creates the pod on the nodes&lt;/li>
&lt;li>invokes the CNI plugin to configure networking for that pod&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;h4 id="kube-proxy">&lt;a href="#kube-proxy" class="header-anchor">&lt;/a>kube-proxy
&lt;/h4>&lt;ul>
&lt;li>runs on each node&lt;/li>
&lt;li>watches the changes in the cluster through kube-api server&lt;/li>
&lt;li>every time a new service is to be crated&lt;/li>
&lt;li>service are not created on each node or assigned to each node
&lt;ul>
&lt;li>service is the cluster wide concept&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>virtual object&lt;/li>
&lt;/ul>
&lt;h4 id="service-ip">&lt;a href="#service-ip" class="header-anchor">&lt;/a>Service IP
&lt;/h4>&lt;ol>
&lt;li>create service obejct in k8s&lt;/li>
&lt;li>it is assigned an IP address from a pre-defined range&lt;/li>
&lt;li>kube-proxy components running on each node, get&amp;rsquo;s that IP address&lt;/li>
&lt;li>creates forwarding rulse on each node in ther clsuter
&lt;ul>
&lt;li>any traffic coming in to service IP, should go the IP of the pod&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="rules-of-service-ip">&lt;a href="#rules-of-service-ip" class="header-anchor">&lt;/a>Rules of service IP
&lt;/h4>&lt;ul>
&lt;li>kube-proxy supports serveral-way
&lt;ul>
&lt;li>userspace&lt;/li>
&lt;li>ipvs&lt;/li>
&lt;li>iptables&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>setting
&lt;ul>
&lt;li>&lt;code>kube-proxy --proxy-mode [userspaces | iptables | ipvs] ...&lt;/code>
&lt;ul>
&lt;li>default: ip tables&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ip tables
&lt;ol>
&lt;li>pod is created it has ip 10.244.1.2&lt;/li>
&lt;li>create a ClusterIP service
&lt;ul>
&lt;li>k8s assigns an IP address to it, 10.103.132.104&lt;/li>
&lt;li>range is specified in kube-api-server option
&lt;ul>
&lt;li>&lt;code>kube-api-server --service-cluster-ip-range ipNet&lt;/code>&lt;/li>
&lt;li>default : 10.0.0.0/24&lt;/li>
&lt;li>&lt;code>ps aux | grep kube-api-server&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>pod ip range and service ip range shoulde be not duplicat ed&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>see the tables
&lt;ul>
&lt;li>&lt;code>iptables -L -t net | grep db-service&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;h4 id="logs">&lt;a href="#logs" class="header-anchor">&lt;/a>Logs
&lt;/h4>&lt;ul>
&lt;li>&lt;code>cat /var/log/kube-proxy.log&lt;/code>
&lt;ul>
&lt;li>what proxy it uses&lt;/li>
&lt;li>IP tables and Add and entry whe new serviec is created&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="dns-in-kubernetes">&lt;a href="#dns-in-kubernetes" class="header-anchor">&lt;/a>DNS in kubernetes
&lt;/h2>&lt;h3 id="objectives">&lt;a href="#objectives" class="header-anchor">&lt;/a>Objectives
&lt;/h3>&lt;ul>
&lt;li>what names are assigned to what obejcts?&lt;/li>
&lt;li>Service DNS records&lt;/li>
&lt;li>POD DNS records&lt;/li>
&lt;/ul>
&lt;h3 id="kube-dns">&lt;a href="#kube-dns" class="header-anchor">&lt;/a>Kube DNS
&lt;/h3>&lt;ul>
&lt;li>service is created&lt;/li>
&lt;li>k8s DNS service creates a record for the service
&lt;ul>
&lt;li>it maps the service name to the IP address&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>any pod can reach the service using its service name
&lt;ul>
&lt;li>&lt;code>&amp;lt;service-name&amp;gt;.&amp;lt;namesapce&amp;gt;.&amp;lt;type&amp;gt;.&amp;lt;Root&amp;gt;&lt;/code>&lt;/li>
&lt;li>subdomain = namespace&lt;/li>
&lt;li>type = svc&lt;/li>
&lt;li>root = cluster.local&lt;/li>
&lt;li>eg) &lt;code>curl http://web-service.apps.svc.cluster.local&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>pod
&lt;ul>
&lt;li>hostname
&lt;ul>
&lt;li>10.224.2.5 → 10-224-2-5&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>type → pod&lt;/li>
&lt;li>eg) &lt;code>curl http://10-224-2-5.apps.pod.cluster.local&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="how-k8s-implements-dns">&lt;a href="#how-k8s-implements-dns" class="header-anchor">&lt;/a>How k8s implements DNS?
&lt;/h2>&lt;h3 id="coredns">&lt;a href="#coredns" class="header-anchor">&lt;/a>CoreDNS
&lt;/h3>&lt;ul>
&lt;li>&lt;code>cat /etc/coredns/Corefile&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl get configmap -n kube-system&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="dns-server">&lt;a href="#dns-server" class="header-anchor">&lt;/a>DNS Server
&lt;/h3>&lt;ul>
&lt;li>node
&lt;ul>
&lt;li>&lt;code>cat /etc/resolv.conf&lt;/code>
&lt;ul>
&lt;li>&lt;code>nameserver 10.96.0.10&lt;/code>&lt;/li>
&lt;li>k8s do automatically&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="ingress">&lt;a href="#ingress" class="header-anchor">&lt;/a>Ingress
&lt;/h2>&lt;h3 id="ingress-controller">&lt;a href="#ingress-controller" class="header-anchor">&lt;/a>Ingress Controller
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-1.png"
loading="lazy"
alt="ingress-controller"
>&lt;/p>
&lt;ul>
&lt;li>nginx deployment
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">extensrions/v1beta1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Deployment&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-ingress-controller&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">replicas&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-ingress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">template&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-ingress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-ingress-controller&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">/nginx-ingress-controller&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- --&lt;span class="l">configmap=$(POD_NAMESPACE)/nginx-configuration&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">POD_NAME&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">valueFrom&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">fieldRef&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">fieldPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">metadata.name&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">POD_NAMESPACE&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">valueFrom&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">fieldRef&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">fieldPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">metadata.namesapce&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">http&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">contrainerPort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">contrainerPort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">443&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>configmap
&lt;ul>
&lt;li>feed nginx configuration data
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ConfigMap&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-configuration&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>service
&lt;ul>
&lt;li>expose
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-ingress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">NodePort&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">targetPort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">http&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">443&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">targetPort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">443&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-ingress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>service account
&lt;ul>
&lt;li>right permissions to access&lt;/li>
&lt;li>Roles&lt;/li>
&lt;li>ClusterRoles&lt;/li>
&lt;li>RoleBindings
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ServiceAccount&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-ingress-serviceaacount&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="ingress-resource">&lt;a href="#ingress-resource" class="header-anchor">&lt;/a>Ingress Resource
&lt;/h3>&lt;ul>
&lt;li>simple one application&lt;/li>
&lt;li>single domain and several subdomains&lt;/li>
&lt;li>several domains&lt;/li>
&lt;li>상태
&lt;ul>
&lt;li>&lt;code>kubectl get ingress&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="rules">&lt;a href="#rules" class="header-anchor">&lt;/a>Rules
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-2.png"
loading="lazy"
alt="ingress-rules"
>&lt;/p>
&lt;h4 id="single">&lt;a href="#single" class="header-anchor">&lt;/a>Single
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-3.png"
loading="lazy"
alt="ingress-single"
>&lt;/p>
&lt;ul>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">extensrions/v1beta1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Ingress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ingress -wear&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">backend&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">serviceName&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">web-service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">servicePort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="several-rules">&lt;a href="#several-rules" class="header-anchor">&lt;/a>Several rules
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-4.png"
loading="lazy"
alt="ingress-serveral-rules"
>&lt;/p>
&lt;ul>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">extensrions/v1beta1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Ingress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ingress -wear&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">rules&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">paths&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/wear&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">backend&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">serviceName&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">wear-service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">servicePort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/watch&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">backend&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">serviceName&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">watch-service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">servicePort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>상태
&lt;ul>
&lt;li>&lt;code>kubectl describe ingress ingress-wear-watch&lt;/code>&lt;/li>
&lt;li>default backend
&lt;ul>
&lt;li>if user access to not specified server&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="several-domains">&lt;a href="#several-domains" class="header-anchor">&lt;/a>Several domains
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-5.png"
loading="lazy"
alt="ingress-serveral-domains"
>&lt;/p>
&lt;ul>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">extensrions/v1beta1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Ingress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ingress-wear&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">rules&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">wear.my-online-store.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">paths&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">backend&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">serviceName&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">wear-service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">servicePort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">watch.my-online-store.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">paths&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">backend&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">serviceName&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">watch-service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">servicePort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>(CKA) 08. Networking Pre-requisites</title><link>https://aiden-jeon.github.io/blog/p/cka-08.-networking-pre-requisites/</link><pubDate>Sun, 06 Jun 2021 00:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-08.-networking-pre-requisites/</guid><description>&lt;p>CKA를 준비하면서 공부한 요약 내용입니다.&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener"
>What is CKA?&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="pre-requisites">&lt;a href="#pre-requisites" class="header-anchor">&lt;/a>Pre-Requisites
&lt;/h2>&lt;ul>
&lt;li>Switching and Routing
&lt;ul>
&lt;li>Switching&lt;/li>
&lt;li>Routing&lt;/li>
&lt;li>Default Gateway&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>DNS
&lt;ul>
&lt;li>DNS Configurations on Linux&lt;/li>
&lt;li>CoreDNS Introduction&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Network Namespaces&lt;/li>
&lt;li>Docker Networking&lt;/li>
&lt;/ul>
&lt;h2 id="switching-routing">&lt;a href="#switching-routing" class="header-anchor">&lt;/a>Switching Routing
&lt;/h2>&lt;h3 id="switching">&lt;a href="#switching" class="header-anchor">&lt;/a>Switching
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-1.png"
loading="lazy"
alt="switching"
>&lt;/p>
&lt;h4 id="상황">&lt;a href="#%ec%83%81%ed%99%a9" class="header-anchor">&lt;/a>상황
&lt;/h4>&lt;ul>
&lt;li>There are two computers and want to communicate to each other
&lt;ul>
&lt;li>→ use switch&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="방법">&lt;a href="#%eb%b0%a9%eb%b2%95" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;ol>
&lt;li>see the interface of host
&lt;ul>
&lt;li>&lt;code>ip link&lt;/code>&lt;/li>
&lt;li>look at the interface named &lt;code>eth0&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>assume ip address
&lt;ul>
&lt;li>switch: 192.168.1.0&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>give ip to hosts
&lt;ul>
&lt;li>&lt;code>ip addr add &amp;lt;ip&amp;gt;/&amp;lt;port&amp;gt; &amp;lt;hostname&amp;gt; &amp;lt;interface&amp;gt;&lt;/code>&lt;/li>
&lt;li>A: 192.168.1.10
&lt;ul>
&lt;li>&lt;code>ip addr add 192.168.1.10/24 dev eth0&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>B: 192.168.1.11
&lt;ul>
&lt;li>&lt;code>ip addr add 192.168.1.11/24 dev eth0&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Two computers can communicate each other through switch
&lt;ul>
&lt;li>&lt;code>ping 192.16.1.11&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="특징">&lt;a href="#%ed%8a%b9%ec%a7%95" class="header-anchor">&lt;/a>특징
&lt;/h4>&lt;ul>
&lt;li>switch can only enable communications within network&lt;/li>
&lt;li>it can receive packets from a host on the network and deliver it to other system within the same network&lt;/li>
&lt;/ul>
&lt;h3 id="routing">&lt;a href="#routing" class="header-anchor">&lt;/a>Routing
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-2.png"
loading="lazy"
alt="routing"
>&lt;/p>
&lt;h4 id="상황-1">&lt;a href="#%ec%83%81%ed%99%a9-1" class="header-anchor">&lt;/a>상황
&lt;/h4>&lt;ul>
&lt;li>New system exists
&lt;ul>
&lt;li>Two computer name with C, D&lt;/li>
&lt;li>Ip address
&lt;ul>
&lt;li>C: 192.168.2.10&lt;/li>
&lt;li>D: 192.168.2.11&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>How does computer A reach to computer c?&lt;/li>
&lt;li>→ Router
&lt;ul>
&lt;li>helps connect two networks together.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="방법-1">&lt;a href="#%eb%b0%a9%eb%b2%95-1" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;ol>
&lt;li>Connecting two networks, it need two ip assigned.
&lt;ul>
&lt;li>first network (A&amp;amp;B): 192.168.1.1&lt;/li>
&lt;li>second network (C&amp;amp;D): 192.168.2.1&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Send A to C
&lt;ul>
&lt;li>how does know where is C?&lt;/li>
&lt;li>→ Gateway&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="gateway">&lt;a href="#gateway" class="header-anchor">&lt;/a>Gateway
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-3.png"
loading="lazy"
alt="gateway"
>&lt;/p>
&lt;h4 id="상황-2">&lt;a href="#%ec%83%81%ed%99%a9-2" class="header-anchor">&lt;/a>상황
&lt;/h4>&lt;ul>
&lt;li>network ← room&lt;/li>
&lt;li>gateway ← a door to the outside world to other networks&lt;/li>
&lt;/ul>
&lt;h4 id="방법-2">&lt;a href="#%eb%b0%a9%eb%b2%95-2" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;ol>
&lt;li>systems need to know where that door is to go through
&lt;ul>
&lt;li>to see the existing routing configuration on a system&lt;/li>
&lt;li>&lt;code>route&lt;/code>&lt;/li>
&lt;li>displays the kernels routing table&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Configure a gateway
&lt;ol>
&lt;li>&lt;code>ip route add 192.168.2.0/24 via 192.168.1.1&lt;/code>
&lt;ul>
&lt;li>→ you can reach the 192.168.2.0 network through the door or gateway at 192.168.1.11&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>route&lt;/code>
&lt;ul>
&lt;li>see the route added&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Configure on all system
&lt;ol>
&lt;li>&lt;code>ip route add 192.168.1.0/24 via 192.168.2.1&lt;/code>&lt;/li>
&lt;li>&lt;code>route&lt;/code>&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;h3 id="internet">&lt;a href="#internet" class="header-anchor">&lt;/a>Internet
&lt;/h3>&lt;h4 id="상황-3">&lt;a href="#%ec%83%81%ed%99%a9-3" class="header-anchor">&lt;/a>상황
&lt;/h4>&lt;ul>
&lt;li>System need acces to the internet&lt;/li>
&lt;/ul>
&lt;h4 id="방법-3">&lt;a href="#%eb%b0%a9%eb%b2%95-3" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;ul>
&lt;li>&lt;code>ip route add 172.217.194.0/24 via 192.168.2.1&lt;/code>
&lt;ul>
&lt;li>add a new road in routing table to road all traffic to the network 172.217.194.0&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="default-gateway">&lt;a href="#default-gateway" class="header-anchor">&lt;/a>Default gateway
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-4.png"
loading="lazy"
alt="default-gateway"
>&lt;/p>
&lt;h4 id="상황-4">&lt;a href="#%ec%83%81%ed%99%a9-4" class="header-anchor">&lt;/a>상황
&lt;/h4>&lt;ul>
&lt;li>any request to any network outside of existing network goes to this particular router&lt;/li>
&lt;/ul>
&lt;h4 id="방법-4">&lt;a href="#%eb%b0%a9%eb%b2%95-4" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;ul>
&lt;li>&lt;code>ip route add default via 192.168.2.1&lt;/code>&lt;/li>
&lt;li>also can called 0.0.0.0
&lt;ul>
&lt;li>&lt;code>ip route add 0.0.0.0 via 192.168.2.1&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>if default gateway is defined, in same network there is no need to add 192.168.1.0&lt;/li>
&lt;li>in sepreated network
&lt;ul>
&lt;li>one entry for private network&lt;/li>
&lt;li>&lt;code>ip addr add 192.168.1.0/24 via 192.168.2.2&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="linux-as-a-host">&lt;a href="#linux-as-a-host" class="header-anchor">&lt;/a>Linux as a host
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-5.png"
loading="lazy"
alt="linux-host"
>&lt;/p>
&lt;h4 id="상황-5">&lt;a href="#%ec%83%81%ed%99%a9-5" class="header-anchor">&lt;/a>상황
&lt;/h4>&lt;ul>
&lt;li>3 hosts, A, B, C&lt;/li>
&lt;li>host B is connected to both networks using eth0 and eth1
&lt;ul>
&lt;li>A&amp;amp;B are connected with 192.168.1.0&lt;/li>
&lt;li>B&amp;amp;C are connected with 192.168.2.0&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>how to reach from A to C
&lt;ul>
&lt;li>→ need to tell host A that the door or gateway to network C is through host B&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="방법-5">&lt;a href="#%eb%b0%a9%eb%b2%95-5" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;ol>
&lt;li>add a routing table entry
&lt;ul>
&lt;li>&lt;code>ip route add 192.168.2.0/24 via 192.168.1.6&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>when packet is reached to host C, host C will have to send back response to host A
&lt;ul>
&lt;li>&lt;code>ip route add 192.168.1.0/24 via 192.168.2.6&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>in Linux, packets are not forwarded from one interface to the next
&lt;ul>
&lt;li>eg) pacets receivced on eht0 on host B, are not forwarded to through eth1&lt;/li>
&lt;li>eth0: private, eth1: public&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>allow forward
&lt;ul>
&lt;li>default: denied
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; cat /proc/sys/net/ipv4/ip_forward
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>set allowed
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; &lt;span class="nb">echo&lt;/span> 1&amp;gt; /proc/sys/net/ipv4/ip_forward
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>this is not persistant, changed if reboot.&lt;/li>
&lt;li>to make persistent, modify the same value in the &lt;code>/etc/sysctl.conf&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">net.ipv4.ip_forward&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="take-aways">&lt;a href="#take-aways" class="header-anchor">&lt;/a>Take Aways
&lt;/h3>&lt;h4 id="ip">&lt;a href="#ip" class="header-anchor">&lt;/a>ip
&lt;/h4>&lt;ul>
&lt;li>&lt;code>ip link&lt;/code>
&lt;ul>
&lt;li>to list and modify interfactes on the host&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>ip addr&lt;/code>
&lt;ul>
&lt;li>to see the ip addresses assigned to those interface&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>ip addr ad&lt;/code>
&lt;ul>
&lt;li>add IP addresses on the interfaces&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="dns">&lt;a href="#dns" class="header-anchor">&lt;/a>DNS
&lt;/h2>&lt;h3 id="name-resolution">&lt;a href="#name-resolution" class="header-anchor">&lt;/a>Name Resolution
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-6.png"
loading="lazy"
alt="name-resolution"
>&lt;/p>
&lt;h4 id="상황-6">&lt;a href="#%ec%83%81%ed%99%a9-6" class="header-anchor">&lt;/a>상황
&lt;/h4>&lt;ul>
&lt;li>two computers A and B
&lt;ul>
&lt;li>same network&lt;/li>
&lt;li>assigned IP
&lt;ul>
&lt;li>A: 192.168.1.0&lt;/li>
&lt;li>B: 192.168.1.11&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>able to ping one computer to others with IP
&lt;ul>
&lt;li>&lt;code>ping 192.168.1.11&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>B has a database service
&lt;ul>
&lt;li>give a name DB&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>want to ping to B, using DB instead of IP address
&lt;ul>
&lt;li>&lt;code>ping db&lt;/code>&lt;/li>
&lt;li>→ err: &lt;code>ping :unkown host db&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="방법-6">&lt;a href="#%eb%b0%a9%eb%b2%95-6" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;ol>
&lt;li>When i say db, it means IP 192.161.1.11
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat &amp;gt;&amp;gt; /etc/hosts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.1.11 db
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>&lt;code>ping db&lt;/code>
&lt;ul>
&lt;li>successful&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="특징-1">&lt;a href="#%ed%8a%b9%ec%a7%95-1" class="header-anchor">&lt;/a>특징
&lt;/h4>&lt;ul>
&lt;li>doesn&amp;rsquo;t matter real host name&lt;/li>
&lt;li>can have many names&lt;/li>
&lt;li>need to all specify other system
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-7.png"
loading="lazy"
alt="name-resoltuions"
>&lt;/li>
&lt;/ul>
&lt;h3 id="dns-server">&lt;a href="#dns-server" class="header-anchor">&lt;/a>DNS Server
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-8.png"
loading="lazy"
alt="before-dns-server"
>
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-9.png"
loading="lazy"
alt="after-dns-server"
>&lt;/p>
&lt;h4 id="상황-7">&lt;a href="#%ec%83%81%ed%99%a9-7" class="header-anchor">&lt;/a>상황
&lt;/h4>&lt;ul>
&lt;li>until the enviroment grew and these files got filled with too many entries&lt;/li>
&lt;li>managing these files too hard&lt;/li>
&lt;li>move all these files in one server&lt;/li>
&lt;li>→ DNS Server
&lt;ul>
&lt;li>point all hosts to look up tahat server&lt;/li>
&lt;li>ip: 192.168.1.100&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="방법-7">&lt;a href="#%eb%b0%a9%eb%b2%95-7" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-10.png"
loading="lazy"
alt="how-dns-server"
>&lt;/p>
&lt;ol>
&lt;li>add entry
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat /etc/resolv.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nameserver 192.168.1.100
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>configure in all host&lt;/li>
&lt;/ol>
&lt;h4 id="특징-2">&lt;a href="#%ed%8a%b9%ec%a7%95-2" class="header-anchor">&lt;/a>특징
&lt;/h4>&lt;ul>
&lt;li>also can use &lt;code>/etc/hosts&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat &amp;gt;&amp;gt; /etc/hosts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.1.115 &lt;span class="nb">test&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>ping test&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>if an entry in both places
&lt;ul>
&lt;li>host first looks in the local &lt;code>/etc/hosts&lt;/code>&lt;/li>
&lt;li>and then look at the name sever&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>order can change
&lt;ul>
&lt;li>&lt;code>etc/nsswitch.conf&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>multiple name server is possible&lt;/li>
&lt;/ul>
&lt;h3 id="domain-names">&lt;a href="#domain-names" class="header-anchor">&lt;/a>Domain Names
&lt;/h3>&lt;h4 id="structure">&lt;a href="#structure" class="header-anchor">&lt;/a>Structure
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-11.png"
loading="lazy"
alt="domain-name-structure"
>&lt;/p>
&lt;ul>
&lt;li>tree structure
&lt;ul>
&lt;li>.com
&lt;ul>
&lt;li>top level domain&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>google
&lt;ul>
&lt;li>domain name&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>www
&lt;ul>
&lt;li>subdomain
&lt;ul>
&lt;li>helping further grouping things together&lt;/li>
&lt;li>eg) maps, drive, ..&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="in-public">&lt;a href="#in-public" class="header-anchor">&lt;/a>In public
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-12.png"
loading="lazy"
alt="domain-name-works-public"
>&lt;/p>
&lt;ol>
&lt;li>request hits organization&amp;rsquo;s internal DNS server&lt;/li>
&lt;li>forwards request to the Internet
&lt;ul>
&lt;li>point to a serving .com&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>forwards to Google&lt;/li>
&lt;li>Google DNS server provides IP of ther serving the apps applications&lt;/li>
&lt;li>to speed up all future results, organization&amp;rsquo;s DNS server choose to cache this IP&lt;/li>
&lt;/ol>
&lt;h3 id="in-private">&lt;a href="#in-private" class="header-anchor">&lt;/a>In private
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-13.png"
loading="lazy"
alt="domain-names-works-private"
>&lt;/p>
&lt;ul>
&lt;li>within in company do not wany to use domain name
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat &amp;gt;&amp;gt; /etc/resolv.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nameserver 192.168.1.100
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">search mycompany.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="record-types">&lt;a href="#record-types" class="header-anchor">&lt;/a>Record Types
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-14.png"
loading="lazy"
alt="record-types"
>&lt;/p>
&lt;h3 id="tools">&lt;a href="#tools" class="header-anchor">&lt;/a>Tools
&lt;/h3>&lt;h4 id="nslookup">&lt;a href="#nslookup" class="header-anchor">&lt;/a>nslookup
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-15.png"
loading="lazy"
alt="nslookup"
>&lt;/p>
&lt;ul>
&lt;li>to query hostname from a DNS server&lt;/li>
&lt;li>does not consider the entries in the local &lt;code>/etc/hosts&lt;/code> file
&lt;ul>
&lt;li>entry for web application has to be present in DNS server.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="dig">&lt;a href="#dig" class="header-anchor">&lt;/a>dig
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-16.png"
loading="lazy"
alt="dig"
>&lt;/p>
&lt;ul>
&lt;li>give more information&lt;/li>
&lt;/ul>
&lt;h2 id="network-namespaces">&lt;a href="#network-namespaces" class="header-anchor">&lt;/a>Network Namespaces
&lt;/h2>&lt;h3 id="process-namespace">&lt;a href="#process-namespace" class="header-anchor">&lt;/a>Process Namespace
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-17.png"
loading="lazy"
alt="process-name"
>&lt;/p>
&lt;ul>
&lt;li>container host
&lt;ul>
&lt;li>create a container, want to make sure that it is isolated&lt;/li>
&lt;li>create a special room, called namespace&lt;/li>
&lt;li>only sees the processes run by container&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>underlying host
&lt;ul>
&lt;li>has visibility in to all of the proceeses
&lt;ul>
&lt;li>including those running inside containers&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="network-namespace">&lt;a href="#network-namespace" class="header-anchor">&lt;/a>Network namespace
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-18.png"
loading="lazy"
alt="network-namespace"
>&lt;/p>
&lt;ul>
&lt;li>host has its own intercates that connect to the local area network&lt;/li>
&lt;li>own routing table, arp table
&lt;ul>
&lt;li>information about rest of the network&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="방법-8">&lt;a href="#%eb%b0%a9%eb%b2%95-8" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;ol>
&lt;li>create a container&lt;/li>
&lt;li>create a network namespace for it
&lt;ul>
&lt;li>it has no visibility to any network related infromation on the host within its namespace&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>the container have its own virtual interfaces, routing and arp tables&lt;/li>
&lt;/ol>
&lt;h4 id="create-network-namespace">&lt;a href="#create-network-namespace" class="header-anchor">&lt;/a>Create network namespace
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-19.png"
loading="lazy"
alt="create-ns"
>&lt;/p>
&lt;ul>
&lt;li>생성
&lt;ul>
&lt;li>&lt;code>ip netns add red&lt;/code>&lt;/li>
&lt;li>&lt;code>ip netns add blue&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>상태
&lt;ul>
&lt;li>&lt;code>ip netns&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="exec-in-network-ns">&lt;a href="#exec-in-network-ns" class="header-anchor">&lt;/a>Exec in network ns
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-20.png"
loading="lazy"
alt="exec-ns"
>&lt;/p>
&lt;ul>
&lt;li>interfaces
&lt;ul>
&lt;li>to list interfaces on my host
&lt;ul>
&lt;li>&lt;code>ip link&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>to list interfaces on network namespace
&lt;ul>
&lt;li>&lt;code>ip netns exec red ip link&lt;/code>&lt;/li>
&lt;li>&lt;code>ip -n red link&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>arp &amp;amp; route table
&lt;ul>
&lt;li>no entries in namespace&lt;/li>
&lt;li>these namespaces has no connectivity to other network&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="connect">&lt;a href="#connect" class="header-anchor">&lt;/a>Connect
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-21.png"
loading="lazy"
alt="connect-ns"
>&lt;/p>
&lt;ul>
&lt;li>connect namespaces together using a virtual ehternet pair or a virtual cable&lt;/li>
&lt;/ul>
&lt;h4 id="방법-9">&lt;a href="#%eb%b0%a9%eb%b2%95-9" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;ol>
&lt;li>create the cable
&lt;ul>
&lt;li>&lt;code>ip link add veth-red type veth peer name veth-blue&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>attach each interface to the appropriate namespace
&lt;ul>
&lt;li>&lt;code>ip link set veth-red netns red&lt;/code>&lt;/li>
&lt;li>&lt;code>ip link set veth-blue netns blue&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>assign IP addresses to each of these namespaces
&lt;ul>
&lt;li>&lt;code>ip -n red addr add 192.168.15.1 dev veth-red&lt;/code>&lt;/li>
&lt;li>&lt;code>ip -n blue addr add 192.168.15.2 dev veth-blue&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>bring up the interface
&lt;ul>
&lt;li>&lt;code>ip -n red link set veth-red up&lt;/code>&lt;/li>
&lt;li>&lt;code>ip -n blue link set veth-blue up&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="확인">&lt;a href="#%ed%99%95%ec%9d%b8" class="header-anchor">&lt;/a>확인
&lt;/h4>&lt;ul>
&lt;li>arp table is created
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-22.png"
loading="lazy"
alt="arp-table"
>&lt;/li>
&lt;/ul>
&lt;h3 id="virtual-network">&lt;a href="#virtual-network" class="header-anchor">&lt;/a>Virtual network
&lt;/h3>&lt;ul>
&lt;li>many pods → need a switch&lt;/li>
&lt;li>create a virtual switch&lt;/li>
&lt;li>how to create virtual networks?
&lt;ul>
&lt;li>여러 open source들&lt;/li>
&lt;li>여기선 linux bridge&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="생성">&lt;a href="#%ec%83%9d%ec%84%b1" class="header-anchor">&lt;/a>생성
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-23.png"
loading="lazy"
alt="create-vns"
>&lt;/p>
&lt;ol>
&lt;li>add a new interface to the host
&lt;ul>
&lt;li>&lt;code>ip link add v-net-0 type bridge&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>check
&lt;ul>
&lt;li>&lt;code>ip link&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>turn up
&lt;ul>
&lt;li>&lt;code>ip link set de v-net-0 up&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>connect the namespaces to new virtual network switch&lt;/li>
&lt;/ol>
&lt;h4 id="연결">&lt;a href="#%ec%97%b0%ea%b2%b0" class="header-anchor">&lt;/a>연결
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-24.png"
loading="lazy"
alt="connect-vns"
>&lt;/p>
&lt;ol>
&lt;li>create a cable
&lt;ul>
&lt;li>&lt;code>ip link add veth-red type veth peer name veth-red-br&lt;/code>&lt;/li>
&lt;li>&lt;code>ip link add veth-blue type veth peer name veth-blue-br&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>attach one end of this interface to the red namespace
&lt;ul>
&lt;li>&lt;code>ip link set veth-red netns red&lt;/code>&lt;/li>
&lt;li>&lt;code>ip link set veth-red-br master v-net-0&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>same job with 2 in blue
&lt;ul>
&lt;li>&lt;code>ip link set veth-blue netns blue&lt;/code>&lt;/li>
&lt;li>&lt;code>ip link set veth-blue-br master v-net-0&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>assign ip address
&lt;ul>
&lt;li>&lt;code>ip -n red addr add 192.168.15.1 dev veth-red&lt;/code>&lt;/li>
&lt;li>&lt;code>ip -n blue addr add 192.168.15.2 dev veth-blue&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>turn devices up
&lt;ul>
&lt;li>&lt;code>ip -n red link set veth-red up&lt;/code>&lt;/li>
&lt;li>&lt;code>ip -n blue link set veth-blue up&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="host-and-namespace">&lt;a href="#host-and-namespace" class="header-anchor">&lt;/a>Host and namespace
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-25.png"
loading="lazy"
alt="host-vns"
>&lt;/p>
&lt;ul>
&lt;li>try trired to reach one of these interfaces in this namespaces from my host
&lt;ul>
&lt;li>→ doesn&amp;rsquo;t work&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>connect interface with host
&lt;ul>
&lt;li>&lt;code>ip addr add 192.168.15.5/25 dev net-0&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="localhost">&lt;a href="#localhost" class="header-anchor">&lt;/a>Localhost
&lt;/h3>&lt;h4 id="상황-8">&lt;a href="#%ec%83%81%ed%99%a9-8" class="header-anchor">&lt;/a>상황
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-26.png"
loading="lazy"
alt="localhost-status"
>&lt;/p>
&lt;ul>
&lt;li>can&amp;rsquo;t reach the outside world and no one from outside world can not reach hosted inside&lt;/li>
&lt;li>how to configure this bridge to reach the network through the internet port?
&lt;ul>
&lt;li>→ need to add an entry in to the routing table to provide a gateway or door to the outside world&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>localhost
&lt;ul>
&lt;li>has all these namesapces&lt;/li>
&lt;li>has an interface to attach to the private network&lt;/li>
&lt;li>a gateway that connects the two networks toghter&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="방법-10">&lt;a href="#%eb%b0%a9%eb%b2%95-10" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-27.png"
loading="lazy"
alt="localhost-method"
>&lt;/p>
&lt;ol>
&lt;li>add localhost to router
&lt;ul>
&lt;li>&lt;code>ip netns exec blue ip route add 192.168.1.0/24 via 192.168.15.5&lt;/code>&lt;/li>
&lt;li>host has two ip addresses
&lt;ul>
&lt;li>192.168.15.5&lt;/li>
&lt;li>external network: 192.168.1.2&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>forward
&lt;ul>
&lt;li>&lt;code>iptables -t nat -A POSTROUT -s 192.168.15.0/25 -j MASQUERADE&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>connect to internet
&lt;ul>
&lt;li>&lt;code>ip netns exec blue ip route add default via 192.168.15.5&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h2 id="docker-networking">&lt;a href="#docker-networking" class="header-anchor">&lt;/a>Docker Networking
&lt;/h2>&lt;h3 id="single-docker-host">&lt;a href="#single-docker-host" class="header-anchor">&lt;/a>Single Docker host
&lt;/h3>&lt;ul>
&lt;li>Has an ethernet interface at eth0 that connects to the local network with the IP address 192.168.1.10&lt;/li>
&lt;li>run a container, there is different networking option to choose from
&lt;ul>
&lt;li>none network&lt;/li>
&lt;li>host network&lt;/li>
&lt;li>bridge&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="none-network">&lt;a href="#none-network" class="header-anchor">&lt;/a>None network
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-28.png"
loading="lazy"
alt="docker-none"
>&lt;/p>
&lt;ul>
&lt;li>docker container is not attached to any network&lt;/li>
&lt;/ul>
&lt;h4 id="host-network">&lt;a href="#host-network" class="header-anchor">&lt;/a>Host network
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-29.png"
loading="lazy"
alt="docker-host"
>&lt;/p>
&lt;ul>
&lt;li>container is attached to the host&amp;rsquo;s network&lt;/li>
&lt;li>sharing host network, cannot use same port at same time&lt;/li>
&lt;/ul>
&lt;h4 id="bridge">&lt;a href="#bridge" class="header-anchor">&lt;/a>Bridge
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-30.png"
loading="lazy"
alt="docker-bridge"
>&lt;/p>
&lt;ul>
&lt;li>internal private network is created which the docker host and containers attach to&lt;/li>
&lt;li>ip address: 172.17.0.0&lt;/li>
&lt;/ul>
&lt;h3 id="bridge-1">&lt;a href="#bridge-1" class="header-anchor">&lt;/a>Bridge
&lt;/h3>&lt;h4 id="상태">&lt;a href="#%ec%83%81%ed%83%9c" class="header-anchor">&lt;/a>상태
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-31.png"
loading="lazy"
alt="bridge-status"
>&lt;/p>
&lt;ul>
&lt;li>&lt;code>docker network ls&lt;/code>
&lt;ul>
&lt;li>docker calls the network by the name bridge&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>ip link&lt;/code>
&lt;ul>
&lt;li>host the name of network is created with docker0&lt;/li>
&lt;li>interface is currently down&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>ip addr&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="생성-1">&lt;a href="#%ec%83%9d%ec%84%b1-1" class="header-anchor">&lt;/a>생성
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-32.png"
loading="lazy"
alt="bridge-crate"
>&lt;/p>
&lt;ul>
&lt;li>container is created&lt;/li>
&lt;li>docker creates a network namepsace for it&lt;/li>
&lt;li>&lt;code>ip netns&lt;/code>&lt;/li>
&lt;li>&lt;code>docker inspect ~~&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="attach-container-to-the-bridge">&lt;a href="#attach-container-to-the-bridge" class="header-anchor">&lt;/a>Attach container to the bridge
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-33.png"
loading="lazy"
alt="bridge-attach"
>&lt;/p>
&lt;ol>
&lt;li>creates a virtual cable
&lt;ul>
&lt;li>&lt;code>ip link&lt;/code> on docker host
&lt;ul>
&lt;li>end of the interface which is attached to the local bridge docker0&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>ip -n ~~ link&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>check the ip
&lt;ul>
&lt;li>&lt;code>ip -n ~~ addr&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="port-mapping">&lt;a href="#port-mapping" class="header-anchor">&lt;/a>Port Mapping
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-34.png"
loading="lazy"
alt="port-mapping"
>&lt;/p>
&lt;ul>
&lt;li>port publishing or port mapping options
&lt;ul>
&lt;li>to allow to access the applications hosted on containers&lt;/li>
&lt;li>&lt;code>docker run -p 8080:80 nginx&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="방법-11">&lt;a href="#%eb%b0%a9%eb%b2%95-11" class="header-anchor">&lt;/a>방법
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-35.png"
loading="lazy"
alt="port-mapping-how"
>&lt;/p>
&lt;ul>
&lt;li>requirements
&lt;ul>
&lt;li>forward traffic coming in one port to another port on the server&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>add rules to docker chain&lt;/li>
&lt;li>set destination to include the containers IP&lt;/li>
&lt;li>see the rule
&lt;ul>
&lt;li>&lt;code>iptables -nvL -t nat&lt;/code>
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/networking-pre-36.png"
loading="lazy"
alt="port-mapping-rule"
>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h2 id="cluster-networking">&lt;a href="#cluster-networking" class="header-anchor">&lt;/a>Cluster Networking
&lt;/h2>&lt;h3 id="ip--fqdn">&lt;a href="#ip--fqdn" class="header-anchor">&lt;/a>IP &amp;amp; FQDN
&lt;/h3>&lt;ol>
&lt;li>k8s cluster consists of master and worker nodes&lt;/li>
&lt;li>each node must have at least 1 interface connected to a network&lt;/li>
&lt;li>each interface must have an address configured&lt;/li>
&lt;li>the host must have a unique hostname set, unique MAC address
&lt;ul>
&lt;li>note this if you created the VMs by cloning from existing ones.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="ports">&lt;a href="#ports" class="header-anchor">&lt;/a>PORTS
&lt;/h3>&lt;p>There are some ports to be opened.&lt;/p>
&lt;h4 id="master">&lt;a href="#master" class="header-anchor">&lt;/a>Master
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kube-api&lt;/code> - 6443&lt;/li>
&lt;li>&lt;code>kubelet&lt;/code> - 10250&lt;/li>
&lt;li>&lt;code>kube-scheduler&lt;/code> - 10251&lt;/li>
&lt;li>&lt;code>kube-controller-manager&lt;/code> - 10252&lt;/li>
&lt;li>&lt;code>etcd&lt;/code>
&lt;ul>
&lt;li>2379&lt;/li>
&lt;li>2380, if multiple master nodes&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="worker">&lt;a href="#worker" class="header-anchor">&lt;/a>Worker
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubelet&lt;/code> - 10250&lt;/li>
&lt;li>&lt;code>services&lt;/code> - 30000~32767&lt;/li>
&lt;/ul>
&lt;h3 id="practice">&lt;a href="#practice" class="header-anchor">&lt;/a>Practice
&lt;/h3>&lt;h4 id="what-is-the-network-interface-configured-for-cluster-connectivity-on-the-master-node-node-to-node-communication">&lt;a href="#what-is-the-network-interface-configured-for-cluster-connectivity-on-the-master-node-node-to-node-communication" class="header-anchor">&lt;/a>What is the network interface configured for cluster connectivity on the master node? node-to-node communication
&lt;/h4>&lt;p>Run: &lt;code>kubectl get nodes -o wide&lt;/code> to see the IP address assigned to the controlplane node.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@controlplane:~# kubectl get nodes controlplane -o wide
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP OS-IMAGE KERNEL-VERSION CONTAINER-RUNTIME
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">controlplane Ready control-plane,master 4h46m v1.20.0 10.3.116.12 &amp;lt;none&amp;gt; Ubuntu 18.04.5 LTS 5.4.0-1041-gcp docker://19.3.0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>In this case, the internal IP address used for node for node to node communication is &lt;code>10.3.116.12&lt;/code>.&lt;/p>
&lt;p>&lt;strong>Important Note&lt;/strong> : The result above is just an example, the node IP address will vary for each lab.&lt;/p>
&lt;p>Next, find the network interface to which this IP is assigned by making use of the &lt;code>ip a&lt;/code> command:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@controlplane:~# ip a | grep -B2 10.3.116.12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">16476: eth0@if16477: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1450 qdisc noqueue state UP group default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> link/ether 02:42:0a:03:74:0c brd ff:ff:ff:ff:ff:ff link-netnsid 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> inet 10.3.116.12/24 brd 10.3.116.255 scope global eth0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@controlplane:~#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Here you can see that the interface associated with this IP is eth0 on the host.&lt;/p>
&lt;h4 id="what-is-the-mac-address-assigned-to-node01">&lt;a href="#what-is-the-mac-address-assigned-to-node01" class="header-anchor">&lt;/a>What is the MAC address assigned to node01?
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; arp node01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Address HWtype HWaddress Flags Mask Iface
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10.153.142.8 ether 02:42:0a:99:8e:07 C eth0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>(CKA) 07. Storage</title><link>https://aiden-jeon.github.io/blog/p/cka-07.-storage/</link><pubDate>Sun, 23 May 2021 09:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-07.-storage/</guid><description>&lt;p>CKA를 준비하면서 공부한 요약 내용입니다.&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener"
>What is CKA?&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="docker-storage">&lt;a href="#docker-storage" class="header-anchor">&lt;/a>Docker Storage
&lt;/h2>&lt;h3 id="file-system">&lt;a href="#file-system" class="header-anchor">&lt;/a>File system
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/storage-1.png"
loading="lazy"
alt="img-1"
>&lt;/p>
&lt;h4 id="layered-architecture">&lt;a href="#layered-architecture" class="header-anchor">&lt;/a>Layered architecture
&lt;/h4>&lt;ul>
&lt;li>build
&lt;ul>
&lt;li>application 1
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/storage-2.png"
loading="lazy"
alt="img-2"
>&lt;/li>
&lt;li>application 2
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/storage-3.png"
loading="lazy"
alt="img-3"
>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>run
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/storage-4.png"
loading="lazy"
alt="img-4"
>&lt;/li>
&lt;li>copy-on-write
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/storage-5.png"
loading="lazy"
alt="img-5"
>&lt;/li>
&lt;/ul>
&lt;h4 id="volumes">&lt;a href="#volumes" class="header-anchor">&lt;/a>Volumes
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/storage-6.png"
loading="lazy"
alt="img-6"
>&lt;/p>
&lt;h4 id="volume-mounting">&lt;a href="#volume-mounting" class="header-anchor">&lt;/a>Volume mounting
&lt;/h4>&lt;ul>
&lt;li>create and run
&lt;ul>
&lt;li>create
&lt;ul>
&lt;li>&lt;code>docker volume create data_volume&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>run
&lt;ul>
&lt;li>&lt;code>docker run -v data_volume:/var/lib/mysql mysql&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>create by run
&lt;ul>
&lt;li>&lt;code>docker run -v data_volume2:/var/lib/mysql mysql&lt;/code>&lt;/li>
&lt;li>automatically create data_volume&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="bind-mounting">&lt;a href="#bind-mounting" class="header-anchor">&lt;/a>Bind mounting
&lt;/h4>&lt;ul>
&lt;li>&lt;code>docker run -v /data/mysql:/var/lib/mysql mysql&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="preferred">&lt;a href="#preferred" class="header-anchor">&lt;/a>Preferred
&lt;/h4>&lt;ul>
&lt;li>old
&lt;ul>
&lt;li>&lt;code>-v&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>new
&lt;ul>
&lt;li>&lt;code>--mount&lt;/code>&lt;/li>
&lt;li>&lt;code>docker run --mount type=bind,source=/data/mysql,target=/var/lib/mysql mysql&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="storage-drivers">&lt;a href="#storage-drivers" class="header-anchor">&lt;/a>Storage drivers
&lt;/h3>&lt;ul>
&lt;li>AUFS&lt;/li>
&lt;li>ZFS&lt;/li>
&lt;li>BTFS&lt;/li>
&lt;li>Device Mapper&lt;/li>
&lt;li>Overlay&lt;/li>
&lt;li>Overlay2&lt;/li>
&lt;/ul>
&lt;h3 id="volume-drivers">&lt;a href="#volume-drivers" class="header-anchor">&lt;/a>Volume Drivers
&lt;/h3>&lt;ul>
&lt;li>Local&lt;/li>
&lt;li>Azure File Storage&lt;/li>
&lt;li>Convoy&lt;/li>
&lt;li>&amp;hellip;&lt;/li>
&lt;/ul>
&lt;h2 id="volumes-1">&lt;a href="#volumes-1" class="header-anchor">&lt;/a>Volumes
&lt;/h2>&lt;ul>
&lt;li>docker
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/storage-7.png"
loading="lazy"
alt="img-7"
>&lt;/li>
&lt;li>k8s&lt;br>
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/storage-8.png"
loading="lazy"
alt="img-8"
>&lt;/li>
&lt;/ul>
&lt;h3 id="volumes--mounts">&lt;a href="#volumes--mounts" class="header-anchor">&lt;/a>Volumes &amp;amp; Mounts
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/storage-9.png"
loading="lazy"
alt="img-9"
>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>definition&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadat&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">random-number-generator&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">alpine&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">alpine&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;bin/sh&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;-c&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;shuf -i 0-100 -n 1 &amp;gt;&amp;gt; /opt/number.out;&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumeMounts&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">mountPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/opt&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">data-volume&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">data-volume&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">hostPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Directory&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>hostPath
&lt;ul>
&lt;li>→ single node is possible&lt;/li>
&lt;li>→ not recommended in multi node&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>AWS
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">data-volume&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">awsElastricBlockStore&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumeID&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;lt;volume-id&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">fsType&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ext4&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="persistent-volume">&lt;a href="#persistent-volume" class="header-anchor">&lt;/a>Persistent Volume
&lt;/h2>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/storage-10.png"
loading="lazy"
alt="img-10"
>&lt;/p>
&lt;h3 id="생성">&lt;a href="#%ec%83%9d%ec%84%b1" class="header-anchor">&lt;/a>생성
&lt;/h3>&lt;ul>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">PersistentVolume&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">pv-vol1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">persistentVolumeReclaimPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Retain&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">accessModes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">ReadWriteOnce&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">capacity&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">storage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">1Gi&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">hostPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/tmp/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>accessModes&lt;/code>
&lt;ul>
&lt;li>&lt;code>ReadOnlyMany&lt;/code>&lt;/li>
&lt;li>&lt;code>ReadWriteOnce&lt;/code>&lt;/li>
&lt;li>&lt;code>ReadWriteMany&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>persistentVolumeReclaimPolicy&lt;/code>
&lt;ul>
&lt;li>&lt;code>delete&lt;/code>&lt;/li>
&lt;li>&lt;code>recycle&lt;/code>&lt;/li>
&lt;li>&lt;code>retain&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="상태">&lt;a href="#%ec%83%81%ed%83%9c" class="header-anchor">&lt;/a>상태
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl get persistentvolume&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl get pv&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="persistent-volume-claims">&lt;a href="#persistent-volume-claims" class="header-anchor">&lt;/a>Persistent Volume Claims
&lt;/h2>&lt;ul>
&lt;li>Persistent Volume
&lt;ul>
&lt;li>administrator crates&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Persistent Volume Claims
&lt;ul>
&lt;li>users create to use persistent volume&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="생성-1">&lt;a href="#%ec%83%9d%ec%84%b1-1" class="header-anchor">&lt;/a>생성
&lt;/h3>&lt;ul>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">PersistentVolumeClaim&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myclaim&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">accessModes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">ReadWriteOnce&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">resources&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">requests&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">storage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">500Mi&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="상태-1">&lt;a href="#%ec%83%81%ed%83%9c-1" class="header-anchor">&lt;/a>상태
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl get persistentvolumeclaim&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl get pvc&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="삭제">&lt;a href="#%ec%82%ad%ec%a0%9c" class="header-anchor">&lt;/a>삭제
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl delete persistentvolumne myclaim&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="pod-with-pvc">&lt;a href="#pod-with-pvc" class="header-anchor">&lt;/a>Pod with PVC
&lt;/h2>&lt;h3 id="생성-2">&lt;a href="#%ec%83%9d%ec%84%b1-2" class="header-anchor">&lt;/a>생성
&lt;/h3>&lt;ul>
&lt;li>definition w\ hostPath
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">webapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">event-simulator&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kodekloud/event-simulator&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">LOG_HANDLERS&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">value&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">file&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumeMounts&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">mountPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/log&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">log-volume&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">log-volume&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">hostPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">## directory location on host&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/var/log/webapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">## this field is optional&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Directory&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>definition w\ PVC
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">webapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">event-simulator&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kodekloud/event-simulator&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">LOG_HANDLERS&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">value&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">file&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumeMounts&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">mountPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/log&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">log-volume&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">log-volume&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">persistentVolumeClaim&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">claimName&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">claim-log-1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="storage-class">&lt;a href="#storage-class" class="header-anchor">&lt;/a>Storage Class
&lt;/h2>&lt;h3 id="상태-2">&lt;a href="#%ec%83%81%ed%83%9c-2" class="header-anchor">&lt;/a>상태
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl get storageclass&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl get sc&lt;/code>&lt;/li>
&lt;/ul></description></item><item><title>(CKA) 06. Security</title><link>https://aiden-jeon.github.io/blog/p/cka-06.-security/</link><pubDate>Sun, 23 May 2021 08:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-06.-security/</guid><description>&lt;p>CKA를 준비하면서 공부한 요약 내용입니다.&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener"
>What is CKA?&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="kubernetes-security-primitives">&lt;a href="#kubernetes-security-primitives" class="header-anchor">&lt;/a>Kubernetes Security Primitives
&lt;/h2>&lt;h3 id="secrure-hosts">&lt;a href="#secrure-hosts" class="header-anchor">&lt;/a>Secrure Hosts
&lt;/h3>&lt;ul>
&lt;li>Password based authentication disabled&lt;/li>
&lt;li>SSH Key based authentication&lt;/li>
&lt;/ul>
&lt;h3 id="secure-kubernetes">&lt;a href="#secure-kubernetes" class="header-anchor">&lt;/a>Secure kubernetes
&lt;/h3>&lt;ul>
&lt;li>kube-apiserver
&lt;ul>
&lt;li>Who can access?&lt;/li>
&lt;li>What can they do?&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="authentication">&lt;a href="#authentication" class="header-anchor">&lt;/a>Authentication
&lt;/h3>&lt;h4 id="who-can-access">&lt;a href="#who-can-access" class="header-anchor">&lt;/a>Who can access?
&lt;/h4>&lt;ul>
&lt;li>Files - Username and Passwords&lt;/li>
&lt;li>Fiels - Username and Tokens&lt;/li>
&lt;li>Certificates&lt;/li>
&lt;li>External Authenication providers - LDAP&lt;/li>
&lt;li>Service Accounts&lt;/li>
&lt;/ul>
&lt;h3 id="authorization">&lt;a href="#authorization" class="header-anchor">&lt;/a>Authorization
&lt;/h3>&lt;h4 id="what-can-they-do">&lt;a href="#what-can-they-do" class="header-anchor">&lt;/a>What can they do?
&lt;/h4>&lt;ul>
&lt;li>RBAC Authorization&lt;/li>
&lt;li>ABAC Authorization&lt;/li>
&lt;li>Node Authorization&lt;/li>
&lt;li>Webhook Mode&lt;/li>
&lt;/ul>
&lt;h3 id="tls-certificates">&lt;a href="#tls-certificates" class="header-anchor">&lt;/a>TLS Certificates
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-1.png"
loading="lazy"
alt="tls-certificates-example"
>&lt;/p>
&lt;h3 id="network-policies">&lt;a href="#network-policies" class="header-anchor">&lt;/a>Network Policies
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-2.png"
loading="lazy"
alt="networking-policies-example"
>&lt;/p>
&lt;h2 id="authentication-1">&lt;a href="#authentication-1" class="header-anchor">&lt;/a>Authentication
&lt;/h2>&lt;p>Users&lt;/p>
&lt;ul>
&lt;li>Admins&lt;/li>
&lt;li>Developers&lt;/li>
&lt;li>Application End Users&lt;/li>
&lt;li>Bots&lt;/li>
&lt;/ul>
&lt;h3 id="accounts">&lt;a href="#accounts" class="header-anchor">&lt;/a>Accounts
&lt;/h3>&lt;ul>
&lt;li>User
&lt;ul>
&lt;li>Admins&lt;/li>
&lt;li>Developers&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Servcie Accounts
&lt;ul>
&lt;li>Bots&lt;/li>
&lt;li>not supported officialy in k8s&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="auth-mechanisms">&lt;a href="#auth-mechanisms" class="header-anchor">&lt;/a>Auth Mechanisms
&lt;/h3>&lt;ul>
&lt;li>kube-apiserver
&lt;ul>
&lt;li>Static Password File&lt;/li>
&lt;li>Static Token File&lt;/li>
&lt;li>Certificates&lt;/li>
&lt;li>Identity Service&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="basic---file">&lt;a href="#basic---file" class="header-anchor">&lt;/a>Basic - file
&lt;/h4>&lt;ul>
&lt;li>&lt;code>user-details.csv&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">password123,user1,u0001
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">password123,user2,u0002
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>&lt;code>kube-apiserver.service&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ExecStart&lt;/span>&lt;span class="o">=&lt;/span>/usr/local/bin/kube-apiserver &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --basic-auth-file&lt;span class="o">=&lt;/span>user-details.csv &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> ...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>kubeadm
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">creationTimestamp&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">null&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kube-apiserver&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kube-system&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">kube-apiserver&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- --&lt;span class="l">authorization-mode=Node,RBAC&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;lt;content-hidden&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- --&lt;span class="l">basic-auth-file=/tmp/users/user-details.csv&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>pod
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kube-apiserver&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kube-system&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">kube-apiserver&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;lt;content-hidden&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">k8s.gcr.io/kube-apiserver-amd64:v1.11.3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kube-apiserver&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumeMounts&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">mountPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/tmp/users&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">usr-details&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">readOnly&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">hostPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/tmp/users&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">DirectoryOrCreate&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">usr-details&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>Authenticate User
&lt;ul>
&lt;li>&lt;code>curl -v -k &amp;lt;https://master-node-ip:6443/api/v1/pods&amp;gt; -u &amp;quot;user1:password123&amp;quot;&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="basic---token">&lt;a href="#basic---token" class="header-anchor">&lt;/a>Basic - token
&lt;/h4>&lt;ul>
&lt;li>&lt;code>user-token-details.csv&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">asdfbasdhjasdhjkfhjk12312,user1,u0001
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1234g23rgy8werfg89asdfasd,user2,u0002
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>&lt;code>kube-apiserver.service&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ExecStart&lt;/span>&lt;span class="o">=&lt;/span>/usr/local/bin/kube-apiserver &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --token-auth-file&lt;span class="o">=&lt;/span>user-details.csv &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> ...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>kubeadm
&lt;ul>
&lt;li>&lt;code>kubectl edit&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Authenticate User
&lt;ul>
&lt;li>&lt;code>curl -v -k &amp;lt;https://master-node-ip:6443/api/v1/pods&amp;gt; --header &amp;quot;Authorization: Bearer asdfbasdhjasdhjkfhjk12312&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="tls">&lt;a href="#tls" class="header-anchor">&lt;/a>TLS
&lt;/h2>&lt;ul>
&lt;li>master node&lt;/li>
&lt;li>worker nodes&lt;/li>
&lt;/ul>
&lt;h3 id="server-certificates-for-servers">&lt;a href="#server-certificates-for-servers" class="header-anchor">&lt;/a>Server Certificates for Servers
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-3.png"
loading="lazy"
alt="server-certificates-for-server"
>&lt;/p>
&lt;h4 id="kube-api-server">&lt;a href="#kube-api-server" class="header-anchor">&lt;/a>Kube-Api server
&lt;/h4>&lt;ul>
&lt;li>exposes a service that other components as well as external users use to manage the k8s cluster&lt;/li>
&lt;li>server
&lt;ul>
&lt;li>certificates to secure all communications with its clients&lt;/li>
&lt;li>&lt;code>apiserver.crt&lt;/code>&lt;/li>
&lt;li>&lt;code>apiserver.key&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="etcd-server">&lt;a href="#etcd-server" class="header-anchor">&lt;/a>ETCD Server
&lt;/h4>&lt;ul>
&lt;li>&lt;code>etcdserver.crt&lt;/code>&lt;/li>
&lt;li>&lt;code>etcdserver.key&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="kubelet-server">&lt;a href="#kubelet-server" class="header-anchor">&lt;/a>KUBELET Server
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubelet.crt&lt;/code>&lt;/li>
&lt;li>&lt;code>kubelet.key&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="client-certificates-for-clients">&lt;a href="#client-certificates-for-clients" class="header-anchor">&lt;/a>Client Certificates for Clients
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-4.png"
loading="lazy"
alt="client-certificates-for-clients"
>&lt;/p>
&lt;h4 id="admin">&lt;a href="#admin" class="header-anchor">&lt;/a>Admin
&lt;/h4>&lt;ul>
&lt;li>&lt;code>admin.crt&lt;/code>&lt;/li>
&lt;li>&lt;code>admin.key&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="kube-scheduler">&lt;a href="#kube-scheduler" class="header-anchor">&lt;/a>Kube-Scheduler
&lt;/h4>&lt;ul>
&lt;li>&lt;code>scheduler.crt&lt;/code>&lt;/li>
&lt;li>&lt;code>scheduler.key&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="kube-controller-manager">&lt;a href="#kube-controller-manager" class="header-anchor">&lt;/a>Kube-Controller-Manager
&lt;/h4>&lt;ul>
&lt;li>&lt;code>controll-manager.crt&lt;/code>&lt;/li>
&lt;li>&lt;code>controll-manager.key&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="kube-proxy">&lt;a href="#kube-proxy" class="header-anchor">&lt;/a>Kube-Proxy
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kube-proxy.crt&lt;/code>&lt;/li>
&lt;li>&lt;code>kube-proxy.key&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="certification-creation">&lt;a href="#certification-creation" class="header-anchor">&lt;/a>Certification Creation
&lt;/h2>&lt;h3 id="openssl-to-create-client-certification">&lt;a href="#openssl-to-create-client-certification" class="header-anchor">&lt;/a>OpenSSL to Create Client Certification
&lt;/h3>&lt;ul>
&lt;li>Certificate Authority(CA)
&lt;ul>
&lt;li>Generate Keys (ca.key)
&lt;ul>
&lt;li>&lt;code>openssl genrsa -out ca.key 2048&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Certificate Signing Requests (ca.csr)
&lt;ul>
&lt;li>&lt;code>openssl req -new -key ca.key -subj &amp;quot;/CN=KUBERNETES-CA&amp;quot; -out ca.csr&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Sign Certificates (ca.crt)
&lt;ul>
&lt;li>&lt;code>openssl x509 -req -in ca.csr -signkey ca.key -out ca.crt&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Admin User
&lt;ul>
&lt;li>Generate Keys (admin.key)
&lt;ul>
&lt;li>&lt;code>openssl genrsa -out admin.key 2048&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Certificate Signing Requests (admin.csr)
&lt;ul>
&lt;li>&lt;code>openssl req -new -key admin.key -subj &amp;quot;/CN=kube-admin/O=system:masters&amp;quot; -out admin.csr&lt;/code>&lt;/li>
&lt;li>&lt;code>&amp;quot;/CN=kube-admin/O=system:masters&amp;quot;&lt;/code> ← admin user&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Sign Certificates (admin.crt)
&lt;ul>
&lt;li>&lt;code>openssl x509 -req -in admin.csr -signkey ca.key -out admin.crt&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Kube Scheduler&lt;/li>
&lt;li>Kube Controller Manager&lt;/li>
&lt;li>kube Proxy&lt;/li>
&lt;/ul>
&lt;h3 id="how-to-use">&lt;a href="#how-to-use" class="header-anchor">&lt;/a>How to use
&lt;/h3>&lt;ul>
&lt;li>&lt;code>curl &amp;lt;https://kube-apisever:6443/api/v1/pods&amp;gt; --key admin.key --cert admin.crt --cacert ca.crt&lt;/code>&lt;/li>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">clusters&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">cluster&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">certificate-authority&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ca.crt&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">server&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;lt;https://kube-apiserver:6443&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kubernetes&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Config&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">users&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kubernetes-admin&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">client-certificate&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">admin.crt&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">clinet-key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">admin.key&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="openssl-to-create-server-certification">&lt;a href="#openssl-to-create-server-certification" class="header-anchor">&lt;/a>OpenSSL to Create Server Certification
&lt;/h3>&lt;h4 id="etcd-servers">&lt;a href="#etcd-servers" class="header-anchor">&lt;/a>ETCD Servers
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">- &lt;span class="l">etcd&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">key-file=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">cert-file=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">peer-cert-file=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">peer-client-cert-auth=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">peer-key-file=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">peer-trusted-ca-cile&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">trusted-ca-file= &lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="kube-api-server-1">&lt;a href="#kube-api-server-1" class="header-anchor">&lt;/a>Kube-Api Server
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-5.png"
loading="lazy"
alt="server-certificate-example"
>&lt;/p>
&lt;ul>
&lt;li>Generate Keys (apiserver.key)
&lt;ul>
&lt;li>&lt;code>openssl genrsa -out apiserver.key 2048&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Certificate Signing Requests (apiserver.csr)
&lt;ul>
&lt;li>&lt;code>openssl.cnf&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[req]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">req_extensions = v3_req
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ v3_req ]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">basicConstraints = CA:FALSE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">keyUsage = nonRpudiation,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">subjectAltName = @alt_names
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[alt_names]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DNS.1 = kubernetes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DNS.2 = kubernetes.default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DNS.3 = kubernetes.default.svc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DNS.4 = kubernetes.default.svc.cluster.local
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP.1 = 10.96.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP.2 = 172.17.0.87
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>&lt;code>openssl req -new -key apiserver.key -subj &amp;quot;/CN=kube-apiserver&amp;quot; -out apiserver.csr -config openssl.cnf&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Sign Certificates (apiserver.crt)
&lt;ul>
&lt;li>&lt;code>openssl x509 -req -in apiserver.csr -CA ca.crt -CAkey ca.key -out apiserver.crt&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="kubelet-server-1">&lt;a href="#kubelet-server-1" class="header-anchor">&lt;/a>Kubelet Server
&lt;/h4>&lt;ul>
&lt;li>server cert
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-6.png"
loading="lazy"
alt="server-cert-examples"
>
&lt;ul>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">kubelet.config.k8s.io/v1beta1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">KubeletConfiguration&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">authentication&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">x509&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">clientCAFile&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/var/lib/kubernetes/ca.pem&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">authorization&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">mode&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Webhook&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">clusterDomain&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;cluster.local&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">clusterDNS&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;10.32.0.10&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">podCIDR&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;$(POD_CIDR)&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">resolveConf&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/run/systemd/resolve/resolv.conf&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">reuntimeRequrestTimeout&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;15m&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">tlsCertFile&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/var/lib/kubelet/kubelet-node01.crt&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">tlsPrivateKeyFile&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/var/lib/kubelet/kubelet-node01.key&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>client cert
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-7.png"
loading="lazy"
alt="client-crt-examples"
>&lt;/li>
&lt;/ul>
&lt;h2 id="view-certificate-details">&lt;a href="#view-certificate-details" class="header-anchor">&lt;/a>View Certificate Details
&lt;/h2>&lt;ul>
&lt;li>The Hard Way
&lt;ul>
&lt;li>&lt;code>cat /etc/systemd/system/kube-apiserver.service&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>kubeadm
&lt;ul>
&lt;li>&lt;code>cat /etc/kubernetes/manifest/kube-apiserver.yaml&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="inspect-service-logs">&lt;a href="#inspect-service-logs" class="header-anchor">&lt;/a>Inspect Service Logs
&lt;/h3>&lt;ul>
&lt;li>&lt;code>journalctl -u etcd.service&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="view-logs">&lt;a href="#view-logs" class="header-anchor">&lt;/a>View Logs
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl logs etcd-master&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="certificates-api">&lt;a href="#certificates-api" class="header-anchor">&lt;/a>Certificates API
&lt;/h2>&lt;h3 id="certificate-signing-request">&lt;a href="#certificate-signing-request" class="header-anchor">&lt;/a>Certificate Signing Request
&lt;/h3>&lt;h4 id="order">&lt;a href="#order" class="header-anchor">&lt;/a>Order
&lt;/h4>&lt;ol>
&lt;li>Create &lt;code>CertificateSigningReqeust&lt;/code> Object&lt;/li>
&lt;li>Review Requests&lt;/li>
&lt;li>Approve Requests&lt;/li>
&lt;li>Share Certs to Users&lt;/li>
&lt;/ol>
&lt;h4 id="request">&lt;a href="#request" class="header-anchor">&lt;/a>Request
&lt;/h4>&lt;ul>
&lt;li>&lt;code>openssl genrsa -out jan.key 2048&lt;/code>&lt;/li>
&lt;li>&lt;code>openssl req -new -key jane.key -subj &amp;quot;/CN=jane&amp;quot; -out jan.csr&lt;/code>&lt;/li>
&lt;li>send to the administrator&lt;/li>
&lt;li>administrator takes the key and creates a &lt;code>CertifacteSigningRequest&lt;/code> obejct
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">certificates.k8s.io/v1beta1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">CeritifcateSigningRequest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">jane&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">groups&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">system:authenticated&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">usage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">digital signature&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">key encipherment&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">server auth&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">request&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;lt;cat jane.csr | base64&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>cat akshay.csr | base64 | tr -d &amp;quot;\\n&amp;quot;&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="approve">&lt;a href="#approve" class="header-anchor">&lt;/a>Approve
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubectl get csr&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k get csr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME AGE SIGNERNAME REQUESTOR CONDITION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">akshay 10s kubernetes.io/kube-apiserver-client kubernetes-admin Pending
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>&lt;code>kubectl certificate approve jane&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="상세-요청">&lt;a href="#%ec%83%81%ec%84%b8-%ec%9a%94%ec%b2%ad" class="header-anchor">&lt;/a>상세 요청
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubectl get csr jane -0 yaml&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="deny">&lt;a href="#deny" class="header-anchor">&lt;/a>Deny
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubectl certificate deny agent-smith&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="delete">&lt;a href="#delete" class="header-anchor">&lt;/a>Delete
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubectl delete csr agent-smith&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="contoller-manager">&lt;a href="#contoller-manager" class="header-anchor">&lt;/a>Contoller Manager
&lt;/h3>&lt;ul>
&lt;li>CSR-APPROVING&lt;/li>
&lt;li>CSR-SIGNING&lt;/li>
&lt;li>&lt;code>cat /etc/kubernetes/manifests/kube-controller-manager.yaml&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="kubeconfig">&lt;a href="#kubeconfig" class="header-anchor">&lt;/a>Kubeconfig
&lt;/h2>&lt;h3 id="using-kubectl-with-crt">&lt;a href="#using-kubectl-with-crt" class="header-anchor">&lt;/a>Using kubectl with crt
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl get pods
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --server my-kube-playground:6443
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --client-key admin.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --client-certificated admin.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --certificate-authority ca.crt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>this is tedious task
&lt;ul>
&lt;li>→ move it to config file&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="using-kubectl-with-config-file">&lt;a href="#using-kubectl-with-config-file" class="header-anchor">&lt;/a>Using kubectl with config file
&lt;/h3>&lt;ul>
&lt;li>config
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl"> --server my-kube-playground:6443
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --client-key admin.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --client-certificated admin.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --certificate-authority ca.crt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>kubectl
&lt;ul>
&lt;li>&lt;code>kubectl get pods --kubeconfig config&lt;/code>&lt;/li>
&lt;li>default config file path
&lt;ul>
&lt;li>&lt;code>.kube/config&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="kubeconfig-file">&lt;a href="#kubeconfig-file" class="header-anchor">&lt;/a>KubeConfig File
&lt;/h3>&lt;ul>
&lt;li>clusters
&lt;ul>
&lt;li>development&lt;/li>
&lt;li>production&lt;/li>
&lt;li>google&lt;/li>
&lt;li>&lt;code>--server my-kube-playground:6443&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>contexts
&lt;ul>
&lt;li>match cluster and users
&lt;ul>
&lt;li>admin@production&lt;/li>
&lt;li>dev@google&lt;/li>
&lt;li>mykubeadmin@mykubeplayground&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>users
&lt;ul>
&lt;li>admin&lt;/li>
&lt;li>dev user&lt;/li>
&lt;li>prod user&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl"> --client-key admin.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --client-certificated admin.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --certificate-authority ca.crt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>defintion
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Config&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">current-context&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">dev-user@google&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">clusters&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">my-kube-playground&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cluster&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">certificate-authority&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ca.crt&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">server&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">my-kube-playground:6443&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">contexts&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">my-kube-admin@my-kube-playground&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">context&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">clusters&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">my-kube-playground&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">my-kube-admin&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">users&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">my-kube-admin&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">client-certificate&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">admin.crt&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">client-key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">admin.key&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>current-context&lt;/code>
&lt;ul>
&lt;li>default context&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>certificate-authority&lt;/code>
&lt;ul>
&lt;li>instead file path using data directly&lt;/li>
&lt;li>&lt;code> certificate-authority-data&lt;/code>
&lt;ul>
&lt;li>with base64 encoding&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="command-line-tool">&lt;a href="#command-line-tool" class="header-anchor">&lt;/a>Command Line Tool
&lt;/h4>&lt;ul>
&lt;li>view
&lt;ul>
&lt;li>&lt;code>kubectl config view&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl config view --kubeconfig=&amp;lt;config-file-name&amp;gt;&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>update
&lt;ul>
&lt;li>&lt;code>kubectl config use-context prod-user@production&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>helo
&lt;ul>
&lt;li>&lt;code>kubectl config -h&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="api-groups">&lt;a href="#api-groups" class="header-anchor">&lt;/a>API Groups
&lt;/h2>&lt;h3 id="example">&lt;a href="#example" class="header-anchor">&lt;/a>Example
&lt;/h3>&lt;ul>
&lt;li>&lt;code>curl &amp;lt;https://kube-master:6443/version&lt;/code>&amp;gt;&lt;/li>
&lt;li>&lt;code>curl &amp;lt;https://kube-master:6443/api/v1/pods&lt;/code>&amp;gt;&lt;/li>
&lt;/ul>
&lt;h3 id="types">&lt;a href="#types" class="header-anchor">&lt;/a>Types
&lt;/h3>&lt;ul>
&lt;li>&lt;code>/metrics&lt;/code>&lt;/li>
&lt;li>&lt;code>/healthz&lt;/code>&lt;/li>
&lt;li>&lt;code>/version&lt;/code>&lt;/li>
&lt;li>&lt;code>/api&lt;/code>&lt;/li>
&lt;li>&lt;code>/apis&lt;/code>&lt;/li>
&lt;li>&lt;code>/logs&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="api-apis">&lt;a href="#api-apis" class="header-anchor">&lt;/a>API, APIS
&lt;/h3>&lt;ul>
&lt;li>&lt;code>api&lt;/code>
&lt;ul>
&lt;li>core group
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-8.png"
loading="lazy"
alt="core-grup"
>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>apis&lt;/code>
&lt;ul>
&lt;li>named group
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-9.png"
loading="lazy"
alt="named-group"
>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>CLT
&lt;ul>
&lt;li>&lt;code>curl &amp;lt;http://localhost:6443&amp;gt; -k&lt;/code>&lt;/li>
&lt;li>&lt;code>curl &amp;lt;http://localhost:6443&amp;gt; -k | grep &amp;quot;name&amp;quot;&lt;/code>&lt;/li>
&lt;li>need certificates file&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>kubectl proxy&lt;/code>
&lt;ul>
&lt;li>to see proxy&lt;/li>
&lt;li>&lt;code>kube proxy&lt;/code> ≠ &lt;code>kubectl proxy&lt;/code>&lt;/li>
&lt;li>&lt;code>kube proxy&lt;/code>
&lt;ul>
&lt;li>enable connectivity betewwnd pods and services across different nodes in the cluster.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>kubectl proxy&lt;/code>
&lt;ul>
&lt;li>HTTP proxy service created by kubectl utility to access the kube-api sever&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="authorization-1">&lt;a href="#authorization-1" class="header-anchor">&lt;/a>Authorization
&lt;/h2>&lt;h3 id="authorization-mechanisms">&lt;a href="#authorization-mechanisms" class="header-anchor">&lt;/a>Authorization Mechanisms
&lt;/h3>&lt;h4 id="types-1">&lt;a href="#types-1" class="header-anchor">&lt;/a>Types
&lt;/h4>&lt;ul>
&lt;li>Node&lt;/li>
&lt;li>ABAC&lt;/li>
&lt;li>RBAC&lt;/li>
&lt;li>Webhook&lt;/li>
&lt;/ul>
&lt;h4 id="node">&lt;a href="#node" class="header-anchor">&lt;/a>Node
&lt;/h4>&lt;ul>
&lt;li>Node Authorizer&lt;/li>
&lt;/ul>
&lt;h4 id="abac">&lt;a href="#abac" class="header-anchor">&lt;/a>ABAC
&lt;/h4>&lt;p>User Attribute Based Authorization&lt;/p>
&lt;ul>
&lt;li>dev-user
&lt;ul>
&lt;li>→ Can view PODs&lt;/li>
&lt;li>→ Can create PODs&lt;/li>
&lt;li>→ Can delete PODs&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="nt">&amp;#34;kind&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Policy&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;spec&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="nt">&amp;#34;user&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;dev-user&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;namespace&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;resource&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;pods&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;apiGroup&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>&lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="rbac">&lt;a href="#rbac" class="header-anchor">&lt;/a>RBAC
&lt;/h4>&lt;p>Rule Based Authorizaion&lt;/p>
&lt;ul>
&lt;li>Developer
&lt;ul>
&lt;li>→ Can view PODs&lt;/li>
&lt;li>→ Can create PODs&lt;/li>
&lt;li>→ Can delete PODs&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rbac.authorization.k8s.io/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Role&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">developer&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">rules&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">apiGroups&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">resources&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;pods&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">verbs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;list&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;get&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;create&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;update&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;delete&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">resourceNames&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;blue&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;orange&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>rules have 3 sections
&lt;ul>
&lt;li>&lt;code>apiGroups&lt;/code>&lt;/li>
&lt;li>&lt;code>resources&lt;/code>&lt;/li>
&lt;li>&lt;code>verbs&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>link users to rule
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rbac.authorization.k8s.io/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">RoleBinding&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">devuser-developer-binding&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">subjects&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">User&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">dev-user&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">apiGroup&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rbac.authorization.k8s.io&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">roleRef&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Role&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">developer&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">apiGroup&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rbac.authorization.k8s.io&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>view
&lt;ul>
&lt;li>&lt;code>kubectl get roles&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl get rolebindings&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Check Access
&lt;ul>
&lt;li>&lt;code>kubectl auth can-i create deployments&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl auth can-i delete nodes&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl auth can-i create deployments --as dev-user&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="webhook">&lt;a href="#webhook" class="header-anchor">&lt;/a>Webhook
&lt;/h4>&lt;ul>
&lt;li>outsource all the mechanism&lt;/li>
&lt;/ul>
&lt;h4 id="alwaysallow">&lt;a href="#alwaysallow" class="header-anchor">&lt;/a>AlwaysAllow
&lt;/h4>&lt;ul>
&lt;li>always allow&lt;/li>
&lt;/ul>
&lt;h4 id="alwaysdeny">&lt;a href="#alwaysdeny" class="header-anchor">&lt;/a>AlwaysDeny
&lt;/h4>&lt;ul>
&lt;li>always deny&lt;/li>
&lt;/ul>
&lt;h3 id="setting">&lt;a href="#setting" class="header-anchor">&lt;/a>Setting
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ExecStart&lt;/span> &lt;span class="o">=&lt;/span> ...&lt;span class="se">\\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --authorization-mode&lt;span class="o">=&lt;/span>AlwaysAllow
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>default : &lt;code>AlwaysAllow&lt;/code>&lt;/li>
&lt;li>multiple mode:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Node,RBAC,Webhook
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>if one&amp;rsquo;s requiest is denied, it pass to next chain&lt;/li>
&lt;li>if approved no more checks.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="inspect">&lt;a href="#inspect" class="header-anchor">&lt;/a>Inspect
&lt;/h3>&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">kubectl describe pod kube-apisever-controlplane -n kube-system
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>--authorizastion mode&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="cluster-roles">&lt;a href="#cluster-roles" class="header-anchor">&lt;/a>Cluster Roles
&lt;/h2>&lt;h3 id="types-2">&lt;a href="#types-2" class="header-anchor">&lt;/a>Types
&lt;/h3>&lt;ul>
&lt;li>namespace ← role
&lt;ul>
&lt;li>pods&lt;/li>
&lt;li>replicasets&lt;/li>
&lt;li>&amp;hellip;&lt;/li>
&lt;li>&lt;code>kubectl api-resources --namespaced=true&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>cluster scoped
&lt;ul>
&lt;li>nodes&lt;/li>
&lt;li>pv&lt;/li>
&lt;li>&amp;hellip;&lt;/li>
&lt;li>&lt;code>kubectl api-resources --namespaced=false&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="clusterroles">&lt;a href="#clusterroles" class="header-anchor">&lt;/a>Clusterroles
&lt;/h3>&lt;ul>
&lt;li>Cluster admin
&lt;ul>
&lt;li>Can view Nodes&lt;/li>
&lt;li>can create Nodes&lt;/li>
&lt;li>Can delete Nodes&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rbac.authorizastion.k8s.io/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ClusterRole&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">cluster-administrator&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">rules&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">apiGroups&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">resources&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;nodes&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">verbs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;list&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;get&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;create&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;delete&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="clusterrolebining">&lt;a href="#clusterrolebining" class="header-anchor">&lt;/a>Clusterrolebining
&lt;/h3>&lt;ul>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rbac.authorization.k8s.io/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ClusterRoleBinding&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">cluster-admin-role-binding&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">subjects&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">User&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">cluster-admin&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">apiGroup&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rbac.authorization.k8s.io&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">roleRef&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ClusterRole&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">cluster-administrator&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">apiGroup&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rbac.authorization.k8s.io&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="image-security">&lt;a href="#image-security" class="header-anchor">&lt;/a>Image Security
&lt;/h2>&lt;h3 id="private-repository">&lt;a href="#private-repository" class="header-anchor">&lt;/a>Private Repository
&lt;/h3>&lt;h4 id="login-to-private-repository">&lt;a href="#login-to-private-repository" class="header-anchor">&lt;/a>Login to private repository
&lt;/h4>&lt;ul>
&lt;li>&lt;code>docker login private-registry.io&lt;/code>&lt;/li>
&lt;li>&lt;code>docker run private-registry.io/apss/internal-app&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="create-secret">&lt;a href="#create-secret" class="header-anchor">&lt;/a>Create secret
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="l">kubectl create secrete docker-registry regcred \\&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">docker-server=private-registry.io \\&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">docker-username=registry-user \\&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">docker-password=registry-password \\&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>--&lt;span class="l">docker-email=registry-user@org.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="create-pod">&lt;a href="#create-pod" class="header-anchor">&lt;/a>Create pod
&lt;/h4>&lt;ul>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Poid&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">private-registry.op/apps/internal-app&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">imagePullSecrets&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">regcred&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="security-context">&lt;a href="#security-context" class="header-anchor">&lt;/a>Security Context
&lt;/h2>&lt;ul>
&lt;li>definition for pod
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">web-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">securityContext&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">runAsUser&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1000&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;sleep&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;3600&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>definition for container
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">web-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;sleep&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;3600&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">securityContext&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">runAsUser&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1000&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">capabilities&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">add&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;AMC_ADMIN&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>capabilities&lt;/code>
&lt;ul>
&lt;li>only supported at the container level&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="network-policy">&lt;a href="#network-policy" class="header-anchor">&lt;/a>Network Policy
&lt;/h2>&lt;h3 id="ingress--egress">&lt;a href="#ingress--egress" class="header-anchor">&lt;/a>Ingress &amp;amp; Egress
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-10.png"
loading="lazy"
alt="ingres-egress-outline"
>&lt;/p>
&lt;ul>
&lt;li>ingress
&lt;ul>
&lt;li>for a web serever the incoming traffic from the users is an ingress&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>egress
&lt;ul>
&lt;li>outgoing request to the app server&lt;/li>
&lt;li>allow external calls&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="traffic">&lt;a href="#traffic" class="header-anchor">&lt;/a>traffic
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/security-11.png"
loading="lazy"
alt="traffic-outline"
>&lt;/p>
&lt;h3 id="network-security">&lt;a href="#network-security" class="header-anchor">&lt;/a>Network Security
&lt;/h3>&lt;ul>
&lt;li>Network Policy
&lt;ul>
&lt;li>eg) Allow Ingress Raffic From API pod on Port 3306&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="selectors">&lt;a href="#selectors" class="header-anchor">&lt;/a>Selectors
&lt;/h4>&lt;ul>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersions&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">networking.k8s.io/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">NetworkPolicy&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">db-policy&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">podSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">mathLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">role&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">db&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">policyTpes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">Ingress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ingress&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">from&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">podSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">api-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3306&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="network-policies-1">&lt;a href="#network-policies-1" class="header-anchor">&lt;/a>Network Policies
&lt;/h2>&lt;ul>
&lt;li>network policy to pod to protect
&lt;ul>
&lt;li>defintion
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersions&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">networking.k8s.io/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">NetworkPolicy&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">db-policy&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">podSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">mathLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">role&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">db&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>what type of policies?
&lt;ul>
&lt;li>ingress or egress or both ?&lt;/li>
&lt;li>allow incoming request → ingress&lt;/li>
&lt;li>if incoming request is allowed, response is allowed automatically&lt;/li>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">policyTpes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">Ingress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>define specific rules
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ingress&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">from&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">podSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">api-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3306&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>allow only in prod namespace
&lt;ul>
&lt;li>definition (and)
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ingress&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">from&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">podSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">api-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespaceSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">prod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3306&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>if only &lt;code>namespaceSelector&lt;/code> is defined
&lt;ul>
&lt;li>allow or request in same namespace&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>definition (or)
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ingress&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">from&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">podSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">api-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">namespaceSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">prod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3306&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>use array&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>to backup in server
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">ipBlock&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">cidr&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">192.168.5.10&lt;/span>&lt;span class="l">/32&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>to push to bakcup server
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersions&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">networking.k8s.io/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">NetworkPolicy&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">db-policy&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">podSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">mathLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">role&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">db&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">policyTpes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">Ingress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">Egress&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ingress&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">from&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">podSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">api-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3306&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">egress&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">to&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">ipBlock&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cidr&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">192.168.5.10&lt;/span>&lt;span class="l">/32&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>(CKA) 05. Cluster Maintenance</title><link>https://aiden-jeon.github.io/blog/p/cka-05.-cluster-maintenance/</link><pubDate>Sat, 22 May 2021 00:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-05.-cluster-maintenance/</guid><description>&lt;p>CKA를 준비하면서 공부한 요약 내용입니다.&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener"
>What is CKA?&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="operating-system-upgrade">&lt;a href="#operating-system-upgrade" class="header-anchor">&lt;/a>Operating System Upgrade
&lt;/h2>&lt;ul>
&lt;li>upgrading base software&lt;/li>
&lt;li>applying security patches&lt;/li>
&lt;/ul>
&lt;h3 id="pod-eviction-timeout">&lt;a href="#pod-eviction-timeout" class="header-anchor">&lt;/a>Pod Eviction Timeout
&lt;/h3>&lt;ul>
&lt;li>waiting pod healthy
&lt;ul>
&lt;li>&lt;code>pod-eviction-timeout=5m0s&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="drain">&lt;a href="#drain" class="header-anchor">&lt;/a>Drain
&lt;/h3>&lt;p>Do not use this node, and all pods are out.&lt;/p>
&lt;ul>
&lt;li>&lt;code>kubectl drain node01&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl drain node01 --ignore-daemonsets&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@controlplane:~# kubectl drain node01 --ignore-daemonsets
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">node/node01 cordoned
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNING: ignoring DaemonSet-managed Pods: kube-system/kube-flannel-ds-x6dgs, kube-system/kube-proxy-jfmxw
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">evicting pod default/blue-746c87566d-wn2qg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">evicting pod default/blue-746c87566d-kt266
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">evicting pod default/blue-746c87566d-9w9zq
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/blue-746c87566d-kt266 evicted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/blue-746c87566d-wn2qg evicted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/blue-746c87566d-9w9zq evicted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">node/node01 evicted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>&lt;code>kubectl drain node01 --ignore-daemonsets --force&lt;/code>&lt;br>
if a pod in node has no replicaset, use &lt;code>--force&lt;/code> option, but a pod will be lost.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@controlplane:~# kubectl drain node01 --ignore-daemonsets --force
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">node/node01 already cordoned
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNING: deleting Pods not managed by ReplicationController, ReplicaSet, Job, DaemonSet or StatefulSet: default/hr-app&lt;span class="p">;&lt;/span> ignoring DaemonSet-managed Pods: kube-system/kube-flannel-ds-x6dgs, kube-system/kube-proxy-jfmxw
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">evicting pod default/hr-app
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/hr-app evicted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">node/node01 evicted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="cordon">&lt;a href="#cordon" class="header-anchor">&lt;/a>Cordon
&lt;/h3>&lt;p>Do not use this node, but exist pods will be running.&lt;/p>
&lt;ul>
&lt;li>&lt;code>kubectl cordon node01&lt;/code>
&lt;ul>
&lt;li>This will ensure that no new pods are scheduled on this node.&lt;/li>
&lt;li>The existing pods will not be affected by this operation.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="uncordon">&lt;a href="#uncordon" class="header-anchor">&lt;/a>Uncordon
&lt;/h3>&lt;p>Can use this node.&lt;/p>
&lt;ul>
&lt;li>&lt;code>kubectl uncordon node01&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="cluster-upgrade-process">&lt;a href="#cluster-upgrade-process" class="header-anchor">&lt;/a>Cluster Upgrade Process
&lt;/h2>&lt;h3 id="supported-versions">&lt;a href="#supported-versions" class="header-anchor">&lt;/a>Supported versions
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/cluster_maintenance-1.png"
loading="lazy"
alt="img-1"
>&lt;/p>
&lt;h4 id="gcp">&lt;a href="#gcp" class="header-anchor">&lt;/a>gcp
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/cluster_maintenance-2.png"
loading="lazy"
alt="img-2"
>&lt;/p>
&lt;h4 id="kubeadm">&lt;a href="#kubeadm" class="header-anchor">&lt;/a>kubeadm
&lt;/h4>&lt;ul>
&lt;li>
&lt;p>&lt;code>kubectl upgrade plan&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@controlplane:~## kubeadm upgrade plan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade/config&lt;span class="o">]&lt;/span> Making sure the configuration is correct:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade/config&lt;span class="o">]&lt;/span> Reading configuration from the cluster...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade/config&lt;span class="o">]&lt;/span> FYI: You can look at this config file with &lt;span class="s1">&amp;#39;kubectl -n kube-system get cm kubeadm-config -oyaml&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>preflight&lt;span class="o">]&lt;/span> Running pre-flight checks.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade&lt;span class="o">]&lt;/span> Running cluster health checks
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade&lt;span class="o">]&lt;/span> Fetching available versions to upgrade to
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade/versions&lt;span class="o">]&lt;/span> Cluster version: v1.19.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade/versions&lt;span class="o">]&lt;/span> kubeadm version: v1.19.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I0522 08:54:38.911002 &lt;span class="m">21647&lt;/span> version.go:252&lt;span class="o">]&lt;/span> remote version is much newer: v1.21.1&lt;span class="p">;&lt;/span> falling back to: stable-1.19
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade/versions&lt;span class="o">]&lt;/span> Latest stable version: v1.19.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade/versions&lt;span class="o">]&lt;/span> Latest stable version: v1.19.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade/versions&lt;span class="o">]&lt;/span> Latest version in the v1.19 series: v1.19.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>upgrade/versions&lt;span class="o">]&lt;/span> Latest version in the v1.19 series: v1.19.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Components that must be upgraded manually after you have upgraded the control plane with &lt;span class="s1">&amp;#39;kubeadm upgrade apply&amp;#39;&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">COMPONENT CURRENT AVAILABLE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubelet &lt;span class="m">2&lt;/span> x v1.19.0 v1.19.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Upgrade to the latest version in the v1.19 series:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">COMPONENT CURRENT AVAILABLE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-apiserver v1.19.0 v1.19.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-controller-manager v1.19.0 v1.19.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-scheduler v1.19.0 v1.19.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-proxy v1.19.0 v1.19.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CoreDNS 1.7.0 1.7.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">etcd 3.4.9-1 3.4.9-1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You can now apply the upgrade by executing the following command:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> kubeadm upgrade apply v1.19.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Note: Before you can perform this upgrade, you have to update kubeadm to v1.19.11.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_____________________________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The table below shows the current state of component configs as understood by this version of kubeadm.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Configs that have a &lt;span class="s2">&amp;#34;yes&amp;#34;&lt;/span> mark in the &lt;span class="s2">&amp;#34;MANUAL UPGRADE REQUIRED&amp;#34;&lt;/span> column require manual config upgrade or
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">resetting to kubeadm defaults before a successful upgrade can be performed. The version to manually
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">upgrade to is denoted in the &lt;span class="s2">&amp;#34;PREFERRED VERSION&amp;#34;&lt;/span> column.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">API GROUP CURRENT VERSION PREFERRED VERSION MANUAL UPGRADE REQUIRED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubeproxy.config.k8s.io v1alpha1 v1alpha1 no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubelet.config.k8s.io v1beta1 v1beta1 no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_____________________________________________________________________
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>kubectl upgrade apply&lt;/code>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="kubeadm-1">&lt;a href="#kubeadm-1" class="header-anchor">&lt;/a>Kubeadm
&lt;/h3>&lt;h4 id="strategy">&lt;a href="#strategy" class="header-anchor">&lt;/a>Strategy
&lt;/h4>&lt;ul>
&lt;li>strategy-1
&lt;ul>
&lt;li>all node down and up&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>strategy-2
&lt;ul>
&lt;li>upgrade node one by one&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>strategy-3
&lt;ul>
&lt;li>add new version node and remove old node&lt;/li>
&lt;li>easy in cluster&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="procedure">&lt;a href="#procedure" class="header-anchor">&lt;/a>Procedure
&lt;/h4>&lt;ul>
&lt;li>master node
&lt;ul>
&lt;li>ver 1
&lt;ul>
&lt;li>&lt;code>apt-get upgrade -y kuebadm=1.12.0-00&lt;/code>&lt;/li>
&lt;li>&lt;code>kubeadm upgrade apply v1.12.0&lt;/code>&lt;/li>
&lt;li>&lt;code>apt-get upgrade -y kubelet=1.12.0-00&lt;/code>&lt;/li>
&lt;li>&lt;code>systemctl restart kubelet&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ver 2
&lt;ul>
&lt;li>&lt;code>apt update&lt;/code>&lt;/li>
&lt;li>&lt;code>apt install kubeadm=1.20.0-00&lt;/code>&lt;/li>
&lt;li>&lt;code>kubeadm upgrade apply v1.20.0&lt;/code>&lt;/li>
&lt;li>&lt;code>apt install kubelet=1.20.0-00&lt;/code>&lt;/li>
&lt;li>&lt;code>systemctl restart kubelet&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>worker node
&lt;ul>
&lt;li>ver 1
&lt;ul>
&lt;li>&lt;code>kubectl drain node01&lt;/code>&lt;/li>
&lt;li>&lt;code>apt-get upgrade -y kuebadm=1.12.0-00&lt;/code>&lt;/li>
&lt;li>&lt;code>apt-get upgrade -y kubelet=1.12.0-00&lt;/code>&lt;/li>
&lt;li>&lt;code>kubeadm upgrade node config --kubelet-version v1.12.0&lt;/code>&lt;/li>
&lt;li>&lt;code>systemctl restart kubelet&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl uncordon node01&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ver 2
&lt;ul>
&lt;li>&lt;code>apt update&lt;/code>&lt;/li>
&lt;li>&lt;code>apt install kubeadm=1.20.0-00&lt;/code>&lt;/li>
&lt;li>&lt;code>kubeadm upgrade node&lt;/code>&lt;/li>
&lt;li>&lt;code>apt install kubelet=1.20.0-00&lt;/code>&lt;/li>
&lt;li>&lt;code>systemctl restart kubelet&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="backup-and-restore">&lt;a href="#backup-and-restore" class="header-anchor">&lt;/a>Backup and Restore
&lt;/h2>&lt;h3 id="backup-candidates">&lt;a href="#backup-candidates" class="header-anchor">&lt;/a>Backup Candidates
&lt;/h3>&lt;ul>
&lt;li>Resource Configuration&lt;/li>
&lt;li>ETCD Cluster&lt;/li>
&lt;li>Persistent Volumes&lt;/li>
&lt;/ul>
&lt;h4 id="resource-configuration">&lt;a href="#resource-configuration" class="header-anchor">&lt;/a>Resource Configuration
&lt;/h4>&lt;ul>
&lt;li>kube-apiserver
&lt;ul>
&lt;li>&lt;code>kubectl get all -A -o yaml &amp;gt; all-deploy-svc.yaml&lt;/code>&lt;/li>
&lt;li>too many resource to do&lt;/li>
&lt;li>→ opensource like VELERO&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="etcd">&lt;a href="#etcd" class="header-anchor">&lt;/a>ETCD
&lt;/h4>&lt;ul>
&lt;li>
&lt;p>method 1&lt;/p>
&lt;ul>
&lt;li>&lt;code>ExecStart= ... \\ --data-dir=/var/lib/etct&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>method 2&lt;/p>
&lt;ul>
&lt;li>&lt;code>ETCDCTL_API=3 etcdctl snapshot save snapshot.db&lt;/code>&lt;/li>
&lt;li>&lt;code>servcie kube-apiserver stop&lt;/code>&lt;/li>
&lt;li>&lt;code>ETCDCTL_API=3 etcdctl snapshot --data-dir /var/lib/etcd-from-backup snapshot restore snapshot.db&lt;/code>&lt;/li>
&lt;li>&lt;code>systemctl daemon-reload&lt;/code>&lt;/li>
&lt;li>&lt;code>service etcd restart&lt;/code>&lt;/li>
&lt;li>&lt;code>service kube-apiserver start&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>backup practice&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ETCDCTL_API&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span> etcdctl --endpoints&lt;span class="o">=&lt;/span>https://&lt;span class="o">[&lt;/span>127.0.0.1&lt;span class="o">]&lt;/span>:2379 &lt;span class="se">\\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--cacert&lt;span class="o">=&lt;/span>/etc/kubernetes/pki/etcd/ca.crt &lt;span class="se">\\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--cert&lt;span class="o">=&lt;/span>/etc/kubernetes/pki/etcd/server.crt &lt;span class="se">\\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--key&lt;span class="o">=&lt;/span>/etc/kubernetes/pki/etcd/server.key &lt;span class="se">\\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snapshot save /opt/snapshot-pre-boot.db
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>restore practice&lt;/p>
&lt;ul>
&lt;li>Restore snapshot
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ETCDCTL_API&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span> etcdctl --data-dir /var/lib/etcd-from-backup &lt;span class="se">\\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snapshot restore /opt/snapshot-pre-boot.db
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>update the &lt;code>/etc/kubernetes/manifests/etcd.yaml&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">volumes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - hostPath:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> path: /var/lib/etcd-from-backup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type: DirectoryOrCreate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: etcd-data
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>(CKA) 04. Application Lifecycle Management</title><link>https://aiden-jeon.github.io/blog/p/cka-04.-application-lifecycle-management/</link><pubDate>Tue, 18 May 2021 00:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-04.-application-lifecycle-management/</guid><description>&lt;p>CKA를 준비하면서 공부한 요약 내용입니다.&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener"
>What is CKA?&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="rollout-and-versioning">&lt;a href="#rollout-and-versioning" class="header-anchor">&lt;/a>Rollout and Versioning
&lt;/h2>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/05-1.png"
loading="lazy"
alt="img-1"
>&lt;/p>
&lt;h3 id="rollout-command">&lt;a href="#rollout-command" class="header-anchor">&lt;/a>Rollout Command
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl rollout status deployment/myapp-deployment&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl rollout history deployment/myapp-deployment&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="deployment-strategy">&lt;a href="#deployment-strategy" class="header-anchor">&lt;/a>Deployment Strategy
&lt;/h3>&lt;h4 id="recreate">&lt;a href="#recreate" class="header-anchor">&lt;/a>Recreate
&lt;/h4>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/05-2.png"
loading="lazy"
alt="img-2"
>&lt;/p>
&lt;ul>
&lt;li>destruction 5&lt;/li>
&lt;li>create 5&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/05-3.png"
loading="lazy"
alt="img-3"
>&lt;/p>
&lt;h4 id="rolling-update">&lt;a href="#rolling-update" class="header-anchor">&lt;/a>Rolling Update
&lt;/h4>&lt;p>→ default strategy&lt;/p>
&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/05-4.png"
loading="lazy"
alt="img-4"
>&lt;/p>
&lt;ul>
&lt;li>destruction and create one by one&lt;/li>
&lt;/ul>
&lt;h3 id="revision">&lt;a href="#revision" class="header-anchor">&lt;/a>Revision
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl apply -f deployment.yaml&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl set image deployment/myapp-deployment nginx=nginx:1.9.1&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="upgrades">&lt;a href="#upgrades" class="header-anchor">&lt;/a>Upgrades
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/05-5.png"
loading="lazy"
alt="img-5"
>&lt;/p>
&lt;ul>
&lt;li>make new replicaset when upgrade deploy&lt;/li>
&lt;/ul>
&lt;h3 id="rollback">&lt;a href="#rollback" class="header-anchor">&lt;/a>Rollback
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/05-6.png"
loading="lazy"
alt="img-6"
>&lt;/p>
&lt;ul>
&lt;li>&lt;code>kubectl rollout undo deployment/myapp-deployment&lt;/code>&lt;/li>
&lt;li>before rollback vs after rollback
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/05-7.png"
loading="lazy"
alt="img-7"
>&lt;/li>
&lt;/ul>
&lt;h2 id="commands-and-arguments">&lt;a href="#commands-and-arguments" class="header-anchor">&lt;/a>Commands and Arguments
&lt;/h2>&lt;ul>
&lt;li>
&lt;p>docker&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-docker" data-lang="docker">&lt;span class="line">&lt;span class="cl">&lt;span class="k">From&lt;/span>&lt;span class="s"> Ubuntu&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">Entrypoint&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;sleep&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">cmd&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;5&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>definition&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu-sleeper-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu-sleeper&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu-sleeper&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;sleep2.0&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;10&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="environment">&lt;a href="#environment" class="header-anchor">&lt;/a>Environment
&lt;/h2>&lt;ul>
&lt;li>
&lt;p>plain Key Value&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">APP_COLOR&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">value&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">pink&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>configMap&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">APP_COLOR&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">valueFrom&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">configMapKeyRef&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>Secrets&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">APP_COLOR&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">valueFrom&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">secretKeyRef&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="configmaps">&lt;a href="#configmaps" class="header-anchor">&lt;/a>ConfigMaps
&lt;/h2>&lt;ul>
&lt;li>create ConfigMap&lt;/li>
&lt;li>Inject into pod&lt;/li>
&lt;/ul>
&lt;h3 id="create">&lt;a href="#create" class="header-anchor">&lt;/a>create
&lt;/h3>&lt;ul>
&lt;li>
&lt;p>imperative&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl create configmap&lt;span class="se">\\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app-config --from-literal&lt;span class="o">=&lt;/span>&lt;span class="nv">APP_COLOR&lt;/span>&lt;span class="o">=&lt;/span>blue &lt;span class="se">\\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --from-literal&lt;span class="o">=&lt;/span>&lt;span class="nv">APP_MODE&lt;/span>&lt;span class="o">=&lt;/span>prod
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>kubectl create configmap app-config --from-file=&amp;lt;path-to-file&amp;gt;&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>declartive&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ConfigMap&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">app-config&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">APP_COLOR&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">blue&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">APP_MODE&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">prod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="view">&lt;a href="#view" class="header-anchor">&lt;/a>view
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl get configmaps&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl describe configmaps&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="configmap-in-pods">&lt;a href="#configmap-in-pods" class="header-anchor">&lt;/a>ConfigMap in Pods
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">simple-webapp-color&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">simple-webapp-color&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">simple-webapp-color&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">envFrom&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">configMapRef&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">app-config&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="secrets">&lt;a href="#secrets" class="header-anchor">&lt;/a>Secrets
&lt;/h2>&lt;ul>
&lt;li>create secret&lt;/li>
&lt;li>inject into pod&lt;/li>
&lt;/ul>
&lt;h3 id="create-1">&lt;a href="#create-1" class="header-anchor">&lt;/a>create
&lt;/h3>&lt;ul>
&lt;li>
&lt;p>imperative&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl create secret generic&lt;span class="se">\\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;secret-name&amp;gt; --from-literal&lt;span class="o">=&lt;/span>&amp;lt;key&amp;gt;&lt;span class="o">=&lt;/span>&amp;lt;value&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>kubectl create secret &amp;lt;secret-name&amp;gt; --from-file=&amp;lt;path-to-file&amp;gt;&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>declartive&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Secret&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">app-secret&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">DB_Host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">mysql&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">DB_User&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">root&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">DB_Passwird&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">paswrd&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>data → encoded format for safe&lt;/li>
&lt;li>&lt;code>echo -n 'mysql' | base64&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="view-1">&lt;a href="#view-1" class="header-anchor">&lt;/a>view
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl get secrets&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl describe secrets&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="decode">&lt;a href="#decode" class="header-anchor">&lt;/a>decode
&lt;/h4>&lt;ul>
&lt;li>&lt;code>echo -n 'abalksdfas=' | base54 --decode&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="secrets-in-pods">&lt;a href="#secrets-in-pods" class="header-anchor">&lt;/a>Secrets in Pods
&lt;/h3>&lt;ul>
&lt;li>
&lt;p>defintion&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">simple-webapp-color&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">simple-webapp-color&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">simple-webapp-color&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">envFrom&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">configMapRef&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">app-secret&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>env&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">envFrom&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">secretRef&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">app-config&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>single env&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">DB_Password&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">valueFrom&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">secretKeyRef&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">app-secret&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">DB_Password&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>volume&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">app-secret-volumne&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">secret&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">secretName&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">app-secret&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>inside the container
&lt;ul>
&lt;li>list
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ls /opt/app-secret-volumes
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>content
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat /opt/app-secret-volumes/DB_Password
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="initcontainers">&lt;a href="#initcontainers" class="header-anchor">&lt;/a>InitContainers
&lt;/h2>&lt;p>In multi-container pod, want to run a process that runs to completion in a container&lt;/p>
&lt;ul>
&lt;li>
&lt;p>initContainer&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp-container&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">busybox:1.28&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;sh&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;-c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;echo The app is running! &amp;amp;&amp;amp; sleep 3600&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">initContainers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">init-myservice&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">busybox&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;sh&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;-c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;git clone &amp;lt;some-repository-that-will-be-used-by-application&amp;gt; ; done;&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>multiple initContainers&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp-container&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">busybox:1.28&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;sh&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;-c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;echo The app is running! &amp;amp;&amp;amp; sleep 3600&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">initContainers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">init-myservice&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">busybox:1.28&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;sh&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;-c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;until nslookup myservice; do echo waiting for myservice; sleep 2; done;&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">init-mydb&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">busybox:1.28&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;sh&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;-c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;until nslookup mydb; do echo waiting for mydb; sleep 2; done;&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>(CKA) 03. Logging &amp; Monitoring</title><link>https://aiden-jeon.github.io/blog/p/cka-03.-logging-monitoring/</link><pubDate>Mon, 17 May 2021 00:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-03.-logging-monitoring/</guid><description>&lt;p>CKA를 준비하면서 공부한 요약 내용입니다.&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener"
>What is CKA?&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="metrics-server">&lt;a href="#metrics-server" class="header-anchor">&lt;/a>Metrics Server
&lt;/h2>&lt;ul>
&lt;li>In-memory&lt;/li>
&lt;li>does not store&lt;/li>
&lt;/ul>
&lt;h4 id="install">&lt;a href="#install" class="header-anchor">&lt;/a>Install
&lt;/h4>&lt;ul>
&lt;li>minikube
&lt;ul>
&lt;li>&lt;code>minikube addons enable metrics-server&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>others
&lt;ul>
&lt;li>&lt;code>git clone &amp;lt;https://github.con/kubernetes-incubator/metrics-server&lt;/code>&amp;gt;&lt;/li>
&lt;li>&lt;code>kubectl create -f deploy/1.8+&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="view">&lt;a href="#view" class="header-anchor">&lt;/a>View
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubeclt top node&lt;/code>&lt;/li>
&lt;li>&lt;code>kubeclt top pod&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="managing-application-logs">&lt;a href="#managing-application-logs" class="header-anchor">&lt;/a>Managing Application Logs
&lt;/h2>&lt;h3 id="logs---k8s">&lt;a href="#logs---k8s" class="header-anchor">&lt;/a>Logs - k8s
&lt;/h3>&lt;h4 id="로그-보기-w-defintion">&lt;a href="#%eb%a1%9c%ea%b7%b8-%eb%b3%b4%ea%b8%b0-w-defintion" class="header-anchor">&lt;/a>로그 보기 w\ defintion
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubectl create -f sample.yaml&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl logs -f sample.yaml&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="여러-container">&lt;a href="#%ec%97%ac%eb%9f%ac-container" class="header-anchor">&lt;/a>여러 container
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubectl logs -f sample.yaml specific-container&lt;/code>&lt;/li>
&lt;/ul></description></item><item><title>(CKA) 02. Scheduler</title><link>https://aiden-jeon.github.io/blog/p/cka-02.-scheduler/</link><pubDate>Sun, 16 May 2021 00:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-02.-scheduler/</guid><description>&lt;p>CKA를 준비하면서 공부한 요약 내용입니다.&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener"
>What is CKA?&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="node-name">&lt;a href="#node-name" class="header-anchor">&lt;/a>Node name
&lt;/h2>&lt;ul>
&lt;li>default: &lt;code>kubectl-scheduler&lt;/code>&lt;/li>
&lt;li>위 작업이 기본적으로 pod을 node에 할당해 줌&lt;/li>
&lt;/ul>
&lt;h3 id="상태-확인">&lt;a href="#%ec%83%81%ed%83%9c-%ed%99%95%ec%9d%b8" class="header-anchor">&lt;/a>상태 확인
&lt;/h3>&lt;ul>
&lt;li>
&lt;p>&lt;code>kubectl get node&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>node&lt;/code> = &lt;code>no&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="l">&amp;gt; k get no&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">NAME STATUS ROLES AGE VERSION&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">controlplane Ready control-plane,master 11m v1.20.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">node01 Ready &amp;lt;none&amp;gt; 9m48s v1.20.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="수동-배정">&lt;a href="#%ec%88%98%eb%8f%99-%eb%b0%b0%ec%a0%95" class="header-anchor">&lt;/a>수동 배정
&lt;/h3>&lt;ul>
&lt;li>To schedule node manually&lt;/li>
&lt;li>&lt;code>NodeName&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">nodeName&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">node01&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="label--selectors">&lt;a href="#label--selectors" class="header-anchor">&lt;/a>Label &amp;amp; Selectors
&lt;/h2>&lt;h3 id="label">&lt;a href="#label" class="header-anchor">&lt;/a>Label
&lt;/h3>&lt;ul>
&lt;li>
&lt;p>definition&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">~~&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">~~&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">~~&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">App1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">function&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Front-end&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">sepc&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">~~&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>→ on &lt;code>metadata: labels&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>imperative&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="l">kubectl label node node01 key=value&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="select">&lt;a href="#select" class="header-anchor">&lt;/a>Select
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl get pods --selector app=App1&lt;/code>&lt;/li>
&lt;li>several selector field
&lt;ul>
&lt;li>&lt;code>kubectl get pods --selector app=App1,env=dev&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="replicaset">&lt;a href="#replicaset" class="header-anchor">&lt;/a>Replicaset
&lt;/h3>&lt;ul>
&lt;li>&lt;code>replica-definition.yaml&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">apps/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Replcaset&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">simple-webapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">App1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">function&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Front-end&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">replicas&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">App1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">template&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">App1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">function&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Front-end&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">simple-webapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">simple-webapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>labels at the top are the labels of the replicaset itself.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">apps/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Replcaset&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">simple-webapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">App1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">function&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Front-end&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>in order to connect the replicaset to the pod, configure the selector field
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">App1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="annotations">&lt;a href="#annotations" class="header-anchor">&lt;/a>Annotations
&lt;/h3>&lt;ul>
&lt;li>used to record other detail for informatively purpose&lt;/li>
&lt;li>eg) tool details&lt;/li>
&lt;/ul>
&lt;h2 id="taints-tolerations">&lt;a href="#taints-tolerations" class="header-anchor">&lt;/a>Taints, Tolerations
&lt;/h2>&lt;ul>
&lt;li>taints
&lt;ul>
&lt;li>set on the nodes&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>toleartions
&lt;ul>
&lt;li>set on the pods&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>taints and toleration does not tell the pod to go to a particular node&lt;/li>
&lt;li>node to only accept pod with certain tolerations&lt;/li>
&lt;/ul>
&lt;h3 id="taints">&lt;a href="#taints" class="header-anchor">&lt;/a>Taints
&lt;/h3>&lt;h4 id="설정">&lt;a href="#%ec%84%a4%ec%a0%95" class="header-anchor">&lt;/a>설정
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubectl taint nodes node-name key=value:taint-effect&lt;/code>&lt;/li>
&lt;li>&lt;code>taint-effect&lt;/code> :
&lt;ul>
&lt;li>&lt;code>NoSchedule&lt;/code>
&lt;ul>
&lt;li>not to be scheduled, if they do not tolerate the taint&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>PreferNoSchedule&lt;/code>
&lt;ul>
&lt;li>system will be try to avoid placing a pod on the node, not guaranteed&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>NoExecute&lt;/code>
&lt;ul>
&lt;li>new pods will not be scheduled on the node&lt;/li>
&lt;li>existing pods on the node will be evicted if the do not tolertae the taint&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="확인">&lt;a href="#%ed%99%95%ec%9d%b8" class="header-anchor">&lt;/a>확인
&lt;/h4>&lt;ul>
&lt;li>describe &amp;amp; grep
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="l">k describe node node01 |grep -i taints&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">Taints&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;lt;none&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="제거">&lt;a href="#%ec%a0%9c%ea%b1%b0" class="header-anchor">&lt;/a>제거
&lt;/h4>&lt;ul>
&lt;li>&lt;code>kubectl taint nodes node-name key=value:taint-effect-&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl taint nodes master/controlplane node-role.kubernetes.io/master:NoSchedule-
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="tolerations">&lt;a href="#tolerations" class="header-anchor">&lt;/a>Tolerations
&lt;/h3>&lt;h4 id="설정-1">&lt;a href="#%ec%84%a4%ec%a0%95-1" class="header-anchor">&lt;/a>설정
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-container&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">tolerations&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;app&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">operator&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;Equal&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">value&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;blue&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">effect&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;NoSchedule&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="pods-to-node">&lt;a href="#pods-to-node" class="header-anchor">&lt;/a>PODs to Node
&lt;/h2>&lt;ol>
&lt;li>Node Selector&lt;/li>
&lt;li>Node Affinity&lt;/li>
&lt;/ol>
&lt;h3 id="node-selector">&lt;a href="#node-selector" class="header-anchor">&lt;/a>Node Selector
&lt;/h3>&lt;ul>
&lt;li>
&lt;p>Label nodes&lt;/p>
&lt;/li>
&lt;li>
&lt;p>use &lt;code>nodeSelector&lt;/code> with label&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">nodeSelector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">size&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Large&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>limitations&lt;/p>
&lt;ul>
&lt;li>only use single label&lt;/li>
&lt;li>there should be complex constraints&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="node-affinity">&lt;a href="#node-affinity" class="header-anchor">&lt;/a>Node Affinity
&lt;/h3>&lt;ul>
&lt;li>&lt;code>nodeSelector&lt;/code> vs &lt;code>affinity&lt;/code>
&lt;ul>
&lt;li>two are working equally, schedule pods to &lt;code>Large&lt;/code> node.
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-0.png"
loading="lazy"
alt="img-0"
>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="설정-2">&lt;a href="#%ec%84%a4%ec%a0%95-2" class="header-anchor">&lt;/a>설정
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">affinity&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">nodeAffinity&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">requireDuringSchedulingIgnoredDuringExecution&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">nodeSelectorTerms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">matchExpressions&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">operator&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">values&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>operator&lt;/code>
&lt;ul>
&lt;li>&lt;code>In&lt;/code>
&lt;ul>
&lt;li>guarantee to schedule in values&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>NotIn&lt;/code>
&lt;ul>
&lt;li>guarantee not to schedule in values&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>Exists&lt;/code>
&lt;ul>
&lt;li>given key exists or not&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="node-affinity-types">&lt;a href="#node-affinity-types" class="header-anchor">&lt;/a>Node Affinity Types
&lt;/h4>&lt;ul>
&lt;li>available
&lt;ul>
&lt;li>&lt;code>requireDuringSchedulingIgnoredDuringExecution&lt;/code>&lt;/li>
&lt;li>&lt;code>preferredDuringSchedulingIgnoredDuringExecution&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>planned
&lt;ul>
&lt;li>&lt;code>requireDuringSchedulingRequiredDuringExecution&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>two states in the life cycle of pod
&lt;ul>
&lt;li>&lt;code>DuringScheduling&lt;/code>
&lt;ul>
&lt;li>&lt;code>Required&lt;/code>
&lt;ul>
&lt;li>must be&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>Preferred&lt;/code>
&lt;ul>
&lt;li>best to&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>DuringExecution&lt;/code>
&lt;ul>
&lt;li>&lt;code>Ignored&lt;/code>
&lt;ul>
&lt;li>if they are scheduled, will not impact them.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>Required&lt;/code>
&lt;ul>
&lt;li>pod will be evicted&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="resource-limits">&lt;a href="#resource-limits" class="header-anchor">&lt;/a>Resource Limits
&lt;/h2>&lt;h3 id="resource-requests">&lt;a href="#resource-requests" class="header-anchor">&lt;/a>Resource Requests
&lt;/h3>&lt;h4 id="설정-3">&lt;a href="#%ec%84%a4%ec%a0%95-3" class="header-anchor">&lt;/a>설정
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">resources&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">requests&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">memory&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;1Gi&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cpu&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>cpu:
&lt;ul>
&lt;li>0.1 == 100mi&lt;/li>
&lt;li>lower: 1mi&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>memory
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-.1png"
loading="lazy"
alt="img-1"
>&lt;/li>
&lt;/ul>
&lt;h3 id="resources-limits">&lt;a href="#resources-limits" class="header-anchor">&lt;/a>Resources Limits
&lt;/h3>&lt;h4 id="설정-4">&lt;a href="#%ec%84%a4%ec%a0%95-4" class="header-anchor">&lt;/a>설정
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">resources&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">requests&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">memory&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;1Gi&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cpu&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">limits&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">memory&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;2Gi&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cpu&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>default
&lt;ul>
&lt;li>1v CPU&lt;/li>
&lt;li>512Mi&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="daemon-sets">&lt;a href="#daemon-sets" class="header-anchor">&lt;/a>Daemon Sets
&lt;/h2>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-2.png"
loading="lazy"
alt="img-2"
>&lt;/p>
&lt;ul>
&lt;li>one copy of the pod is always present in all nodes in the cluster&lt;/li>
&lt;/ul>
&lt;h3 id="use-case">&lt;a href="#use-case" class="header-anchor">&lt;/a>use case
&lt;/h3>&lt;ul>
&lt;li>monitoring
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-3.png"
loading="lazy"
alt="img-3"
>&lt;/li>
&lt;li>kube-proxy
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-4.png"
loading="lazy"
alt="img-4"
>&lt;/li>
&lt;li>networking
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-5.png"
loading="lazy"
alt="img-5"
>&lt;/li>
&lt;/ul>
&lt;h3 id="생성">&lt;a href="#%ec%83%9d%ec%84%b1" class="header-anchor">&lt;/a>생성
&lt;/h3>&lt;ul>
&lt;li>
&lt;p>&lt;code>DaemonSet&lt;/code> vs &lt;code>ReplicaSet&lt;/code>
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-6.png"
loading="lazy"
alt="img-6"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>definition&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">apps/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">DaemonSet&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">monitoring-daemon&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">monitoring-daemon&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">template&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">monitoring-daemon&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">contaiers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">monitoring-agent&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">monitoring-agent&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="상태">&lt;a href="#%ec%83%81%ed%83%9c" class="header-anchor">&lt;/a>상태
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl get daemonsets&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="static-pods">&lt;a href="#static-pods" class="header-anchor">&lt;/a>Static PODs
&lt;/h2>&lt;h3 id="static-pods-vs-daemonsets">&lt;a href="#static-pods-vs-daemonsets" class="header-anchor">&lt;/a>Static PODs vs DaemonSets
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-7.png"
loading="lazy"
alt="img-7"
>&lt;/p>
&lt;ul>
&lt;li>static pod
&lt;ul>
&lt;li>created directly by kubelet&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="config">&lt;a href="#config" class="header-anchor">&lt;/a>Config
&lt;/h3>&lt;ol>
&lt;li>&lt;code>--pod-manifeset-path=/etc/Kubernetes/manifest&lt;/code>&lt;/li>
&lt;li>&lt;code>--config=kubeconfig.yaml&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># kubeconfig.yaml&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">staticPodPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/etc/Kubernetes/manifest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h4 id="파일-위치">&lt;a href="#%ed%8c%8c%ec%9d%bc-%ec%9c%84%ec%b9%98" class="header-anchor">&lt;/a>파일 위치
&lt;/h4>&lt;p>First idenity the kubelet config file:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">controlplane&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="c1"># ps -aux | grep /usr/bin/kubelet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span> &lt;span class="mi">3668&lt;/span> &lt;span class="mf">0.0&lt;/span> &lt;span class="mf">1.5&lt;/span> &lt;span class="mi">1933476&lt;/span> &lt;span class="mi">63076&lt;/span> &lt;span class="err">?&lt;/span> &lt;span class="n">Ssl&lt;/span> &lt;span class="n">Mar13&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">18&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubelet&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">bootstrap&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">kubeconfig&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubernetes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bootstrap&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">kubelet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">conf&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">kubeconfig&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubernetes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubelet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">conf&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubelet&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">plugin&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">cni&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">pod&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">infra&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">container&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gcr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pause&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mf">3.2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span> &lt;span class="mi">4879&lt;/span> &lt;span class="mf">0.0&lt;/span> &lt;span class="mf">0.0&lt;/span> &lt;span class="mi">11468&lt;/span> &lt;span class="mi">1040&lt;/span> &lt;span class="n">pts&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="n">S&lt;/span>&lt;span class="o">+&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">06&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">grep&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">auto&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubelet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">controlplane&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>From the output we can see that the kubelet config file used is &lt;code>/var/lib/kubelet/config.yaml&lt;/code>&lt;/p>
&lt;p>Next, lookup the value assigned for &lt;code>staticPodPath&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">controlplane&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="c1"># grep -i staticpod /var/lib/kubelet/config.yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">staticPodPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubernetes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">manifests&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">controlplane&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>As you can see, the path configured is the &lt;code>/etc/kubernetes/manifests&lt;/code> directory.&lt;/p>
&lt;h3 id="상태-1">&lt;a href="#%ec%83%81%ed%83%9c-1" class="header-anchor">&lt;/a>상태
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl get po -A&lt;/code>
&lt;ul>
&lt;li>&lt;code>-controlplane&lt;/code> appended pods&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="l">&amp;gt; k get po -A&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">NAMESPACE NAME READY STATUS RESTARTS AGE&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system coredns-74ff55c5b-578df 1/1 Running 0 25m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system coredns-74ff55c5b-nnjdp 1/1 Running 0 25m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system etcd-controlplane 1/1 Running 0 25m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system kube-apiserver-controlplane 1/1 Running 0 25m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system kube-controller-manager-controlplane 1/1 Running 0 25m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system kube-flannel-ds-q7plw 1/1 Running 0 24m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system kube-flannel-ds-w5rnm 1/1 Running 0 25m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system kube-proxy-5dg8f 1/1 Running 0 24m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system kube-proxy-ld2qq 1/1 Running 0 25m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system kube-scheduler-controlplane 1/1 Running 0 25m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>grep -i controlplane&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="l">&amp;gt; k get po -A |grep -i controlplane&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system etcd-controlplane 1/1 Running 0 27m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system kube-apiserver-controlplane 1/1 Running 0 27m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system kube-controller-manager-controlplane 1/1 Running 0 27m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">kube-system kube-scheduler-controlplane 1/1 Running 0 27m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="삭제">&lt;a href="#%ec%82%ad%ec%a0%9c" class="header-anchor">&lt;/a>삭제
&lt;/h3>&lt;p>First, let&amp;rsquo;s identify the node in which the pod called &lt;strong>static-greenbox&lt;/strong> is created. To do this, run:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@controlplane:~# kubectlget pods --all-namespaces -o wide | grep static-greenbox
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">defaultstatic-greenbox-node01 1/1Running 0 19s 10.244.1.2 node01 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@controlplane:~#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>From the result of this command, we can see that the pod is running on node01.&lt;/p>
&lt;p>Next, SSH to node01 and identify the path configured for static pods in this node.&lt;/p>
&lt;p>&lt;code>Important&lt;/code>: The path need not be &lt;code>/etc/kubernetes/manifests&lt;/code>.&lt;/p>
&lt;p>Make sure to check the path configured in the kubelet configuration file.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">controlplane&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="c1"># ssh node01&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">node01&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="c1"># ps -ef | grep /usr/bin/kubelet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span> &lt;span class="mi">752&lt;/span> &lt;span class="mi">654&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">30&lt;/span> &lt;span class="n">pts&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">grep&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">auto&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubelet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span> &lt;span class="mi">28567&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">22&lt;/span> &lt;span class="err">?&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">11&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubelet&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">bootstrap&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">kubeconfig&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubernetes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bootstrap&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">kubelet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">conf&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">kubeconfig&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubernetes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubelet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">conf&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubelet&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">plugin&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">cni&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">pod&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">infra&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">container&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gcr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pause&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mf">3.2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">node01&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="c1"># grep -i staticpod /var/lib/kubelet/config.yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">staticPodPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">just&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">to&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">mess&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">with&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">you&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">node01&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Here the staticPodPath is &lt;code>/etc/just-to-mess-with-you&lt;/code>&lt;/p>
&lt;p>Navigate to this directory and delete the YAML file:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@node01:/etc/just-to-mess-with-you# ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">greenbox.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@node01:/etc/just-to-mess-with-you# rm -rf greenbox.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@node01:/etc/just-to-mess-with-you#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Exit out of node01 using &lt;code>CTRL + D&lt;/code> or type &lt;code>exit&lt;/code>. You should return to the &lt;code>controlplane&lt;/code> node. Check if the &lt;code>static-greenbox&lt;/code> pod has been deleted:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@controlplane:~# kubectl get pods --all-namespaces -o wide | grep static-greenbox
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@controlplane:~#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="multiple-schedulers">&lt;a href="#multiple-schedulers" class="header-anchor">&lt;/a>Multiple Schedulers
&lt;/h2>&lt;h3 id="생성-1">&lt;a href="#%ec%83%9d%ec%84%b1-1" class="header-anchor">&lt;/a>생성
&lt;/h3>&lt;ul>
&lt;li>cli
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-8.png"
loading="lazy"
alt="img-8"
>&lt;/li>
&lt;li>kubeadm
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-9.png"
loading="lazy"
alt="img-9"
>
&lt;ul>
&lt;li>&lt;code>--leader-elect&lt;/code>
&lt;ul>
&lt;li>used when multiple copies of the scheduler running on different master nodes&lt;/li>
&lt;li>who will lead activity&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>--scheduler-name&lt;/code>
&lt;ul>
&lt;li>name of scheduler
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/scheduler-10.png"
loading="lazy"
alt="img-10"
>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>--lock-object-name&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="사용">&lt;a href="#%ec%82%ac%ec%9a%a9" class="header-anchor">&lt;/a>사용
&lt;/h3>&lt;ul>
&lt;li>definition
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">schedulerName&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">my-custom-scheduler&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="상태-2">&lt;a href="#%ec%83%81%ed%83%9c-2" class="header-anchor">&lt;/a>상태
&lt;/h3>&lt;ul>
&lt;li>&lt;code>kubectl get events&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl logs my-custom-scheduler --n kube-system&lt;/code>&lt;/li>
&lt;/ul></description></item><item><title>(CKA) 01. Core Concepts</title><link>https://aiden-jeon.github.io/blog/p/cka-01.-core-concepts/</link><pubDate>Mon, 10 May 2021 00:00:00 +0000</pubDate><guid>https://aiden-jeon.github.io/blog/p/cka-01.-core-concepts/</guid><description>&lt;p>CKA를 준비하면서 공부한 요약 내용입니다.&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/" target="_blank" rel="noopener"
>강의&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener"
>What is CKA?&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="0-tips">&lt;a href="#0-tips" class="header-anchor">&lt;/a>0. Tips
&lt;/h2>&lt;ol>
&lt;li>ailias &lt;code>kubectl&lt;/code> to &lt;code>k&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">alias&lt;/span> &lt;span class="nv">k&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;kubectl&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">k get po
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>shortcuts&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>pod = po&lt;/li>
&lt;li>service = svc&lt;/li>
&lt;li>namespace = ns&lt;/li>
&lt;li>replicasets = rs&lt;/li>
&lt;/ul>
&lt;ol start="3">
&lt;li>do not write all config file&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>use dry run
&lt;ul>
&lt;li>&lt;code>kubectl run nginx --image=nginx --dry-run=client -o yaml&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl create deployment --image=nginx nginx --dry-run=client -o yaml&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>export it to yaml file
&lt;ul>
&lt;li>&lt;code>kubectl create deployment --image=nginx nginx --dry-run=client -o yaml &amp;gt; nginx-deployment.yaml&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="1-pods">&lt;a href="#1-pods" class="header-anchor">&lt;/a>1. Pods
&lt;/h2>&lt;h3 id="생성">&lt;a href="#%ec%83%9d%ec%84%b1" class="header-anchor">&lt;/a>생성
&lt;/h3>&lt;ol>
&lt;li>yaml&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># pod.yaml&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-container&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl apply -f pod.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>run&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl run nginx --image&lt;span class="o">=&lt;/span>nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="상태">&lt;a href="#%ec%83%81%ed%83%9c" class="header-anchor">&lt;/a>상태
&lt;/h3>&lt;ul>
&lt;li>
&lt;p>기본&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">newpods-6nl8r 1/1 Running &lt;span class="m">0&lt;/span> 3m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">newpods-9sp8p 1/1 Running &lt;span class="m">0&lt;/span> 3m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">newpods-tplx9 1/1 Running &lt;span class="m">0&lt;/span> 3m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nginx 1/1 Running &lt;span class="m">0&lt;/span> 3m11s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">webapp 1/2 ImagePullBackOff &lt;span class="m">0&lt;/span> 54s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>READY means
&lt;ul>
&lt;li>running_containers in pod / total_containers in pod&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>wide&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k get po -o wide
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">newpods-6nl8r 0/1 ContainerCreating &lt;span class="m">0&lt;/span> 14s &amp;lt;none&amp;gt; controlplane &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">newpods-9sp8p 0/1 ContainerCreating &lt;span class="m">0&lt;/span> 14s &amp;lt;none&amp;gt; controlplane &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">newpods-tplx9 0/1 ContainerCreating &lt;span class="m">0&lt;/span> 14s &amp;lt;none&amp;gt; controlplane &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nginx 0/1 ContainerCreating &lt;span class="m">0&lt;/span> 25s &amp;lt;none&amp;gt; controlplane &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>NODE&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>describe&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k describe po webapp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Name: webapp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Namespace: default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Priority: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Node: controlplane/10.77.67.9
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Start Time: Mon, &lt;span class="m">10&lt;/span> May &lt;span class="m">2021&lt;/span> 03:54:38 +0000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Labels: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Annotations: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Status: Pending
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: 10.244.0.8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IPs:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> IP: 10.244.0.8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Containers:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nginx:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Container ID: docker://f9580f7e4b7c51b53f0cb0d94ff913b643706a65a103a58614c3c254cf26043f
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Image: nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Image ID: docker-pullable://nginx@sha256:75a55d33ecc73c2a242450a9f1cc858499d468f077ea942867e662c247b5e412
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Port: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Host Port: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> State: Running
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Started: Mon, &lt;span class="m">10&lt;/span> May &lt;span class="m">2021&lt;/span> 03:54:41 +0000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Ready: True
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Restart Count: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Environment: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Mounts:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /var/run/secrets/kubernetes.io/serviceaccount from default-token-pz92t &lt;span class="o">(&lt;/span>ro&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> agentx:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Container ID:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Image: agentx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Image ID:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Port: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Host Port: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> State: Waiting
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Reason: ImagePullBackOff
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Ready: False
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Restart Count: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Environment: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Mounts:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /var/run/secrets/kubernetes.io/serviceaccount from default-token-pz92t &lt;span class="o">(&lt;/span>ro&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Conditions:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Type Status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Initialized True
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Ready False
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ContainersReady False
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PodScheduled True
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Volumes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> default-token-pz92t:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Type: Secret &lt;span class="o">(&lt;/span>a volume populated by a Secret&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> SecretName: default-token-pz92t
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Optional: &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">QoS Class: BestEffort
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Node-Selectors: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Tolerations: node.kubernetes.io/not-ready:NoExecute &lt;span class="nv">op&lt;/span>&lt;span class="o">=&lt;/span>Exists &lt;span class="k">for&lt;/span> 300s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> node.kubernetes.io/unreachable:NoExecute &lt;span class="nv">op&lt;/span>&lt;span class="o">=&lt;/span>Exists &lt;span class="k">for&lt;/span> 300s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Events:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Type Reason Age From Message
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ---- ------ ---- ---- -------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Normal Scheduled 17s default-scheduler Successfully assigned default/webapp to controlplane
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Normal Pulling 15s kubelet Pulling image &lt;span class="s2">&amp;#34;nginx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Normal Pulled 15s kubelet Successfully pulled image &lt;span class="s2">&amp;#34;nginx&amp;#34;&lt;/span> in 170.242045ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Normal Created 15s kubelet Created container nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Normal Started 14s kubelet Started container nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Normal Pulling 14s kubelet Pulling image &lt;span class="s2">&amp;#34;agentx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Warning Failed 13s kubelet Failed to pull image &lt;span class="s2">&amp;#34;agentx&amp;#34;&lt;/span>: rpc error: &lt;span class="nv">code&lt;/span> &lt;span class="o">=&lt;/span> Unknown &lt;span class="nv">desc&lt;/span> &lt;span class="o">=&lt;/span> Error response from daemon: pull access denied &lt;span class="k">for&lt;/span> agentx, repository does not exist or may require &lt;span class="s1">&amp;#39;docker login&amp;#39;&lt;/span>: denied: requested access to the resource is denied
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Warning Failed 13s kubelet Error: ErrImagePull
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Normal BackOff 12s &lt;span class="o">(&lt;/span>x2 over 13s&lt;span class="o">)&lt;/span> kubelet Back-off pulling image &lt;span class="s2">&amp;#34;agentx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Warning Failed 12s &lt;span class="o">(&lt;/span>x2 over 13s&lt;span class="o">)&lt;/span> kubelet Error: ImagePullBackOff
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="삭제">&lt;a href="#%ec%82%ad%ec%a0%9c" class="header-anchor">&lt;/a>삭제
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k delete po webapp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod &lt;span class="s2">&amp;#34;webapp&amp;#34;&lt;/span> deleted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="수정">&lt;a href="#%ec%88%98%ec%a0%95" class="header-anchor">&lt;/a>수정
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">k edit po redis
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="2-replication-controller">&lt;a href="#2-replication-controller" class="header-anchor">&lt;/a>2. Replication Controller
&lt;/h2>&lt;p>What is replica and why need controller?&lt;br>
-&amp;gt; replication controller runs multiple instances of a single pod in the k8s cluster&lt;/p>
&lt;h3 id="특징">&lt;a href="#%ed%8a%b9%ec%a7%95" class="header-anchor">&lt;/a>특징
&lt;/h3>&lt;ol>
&lt;li>high availability
&lt;ul>
&lt;li>multiplie pod or single pod&lt;/li>
&lt;li>replication controller ensures that the specified number of pods are running at all times.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Load Balancing &amp;amp; Scaling
&lt;ul>
&lt;li>balance the load&lt;/li>
&lt;li>spans across multiple nodes&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="종류">&lt;a href="#%ec%a2%85%eb%a5%98" class="header-anchor">&lt;/a>종류
&lt;/h3>&lt;ul>
&lt;li>replication controller
&lt;ul>
&lt;li>old technology&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>replica set
&lt;ul>
&lt;li>recommended&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="생성-1">&lt;a href="#%ec%83%9d%ec%84%b1-1" class="header-anchor">&lt;/a>생성
&lt;/h3>&lt;ul>
&lt;li>defintion
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ReplicaSet&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">apps/v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ReplicaSet&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp-replicaset&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">front-end&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">template&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp-pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">front-end&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx-container&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">replicas&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">front-end&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="상태-1">&lt;a href="#%ec%83%81%ed%83%9c-1" class="header-anchor">&lt;/a>상태
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k get replicasets
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME DESIRED CURRENT READY AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">new-replica-set &lt;span class="m">4&lt;/span> &lt;span class="m">4&lt;/span> &lt;span class="m">0&lt;/span> 11s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="수정-1">&lt;a href="#%ec%88%98%ec%a0%95-1" class="header-anchor">&lt;/a>수정
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k edit replicaset
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">replicaset.apps/new-replica-set edited
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="삭제-1">&lt;a href="#%ec%82%ad%ec%a0%9c-1" class="header-anchor">&lt;/a>삭제
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k delete po --all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>-&amp;gt; 자동으로 다시 pod 생성 됨&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ot@controlplane:~# k get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">new-replica-set-7mx8k 0/1 Terminating &lt;span class="m">0&lt;/span> 4m22s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">new-replica-set-7p95n 0/1 ContainerCreating &lt;span class="m">0&lt;/span> 17s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">new-replica-set-dcl5m 0/1 Terminating &lt;span class="m">0&lt;/span> 4m22s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">new-replica-set-hhpm9 0/1 ContainerCreating &lt;span class="m">0&lt;/span> 17s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">new-replica-set-hr54x 0/1 ContainerCreating &lt;span class="m">0&lt;/span> 17s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">new-replica-set-m6dmb 0/1 Terminating &lt;span class="m">0&lt;/span> 4m22s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">new-replica-set-v2vr5 0/1 ContainerCreating &lt;span class="m">0&lt;/span> 17s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">new-replica-set-vmts5 0/1 Terminating &lt;span class="m">0&lt;/span> 4m22s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="scale">&lt;a href="#scale" class="header-anchor">&lt;/a>scale
&lt;/h3>&lt;ol>
&lt;li>replace w\ file
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl replace -f ~~.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>scale w\ file
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl scale --replicas&lt;span class="o">=&lt;/span>&lt;span class="m">6&lt;/span> -f ~~.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>scale w\ resource
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl scale --replicas&lt;span class="o">=&lt;/span>&lt;span class="m">6&lt;/span> replicaset myapp-replicaset
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>edit
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl edit replicaset
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>실습
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k scale --replicas&lt;span class="o">=&lt;/span>&lt;span class="m">5&lt;/span> rs new-replica-set
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">replicaset.apps/new-replica-set scaled
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="3-deployments">&lt;a href="#3-deployments" class="header-anchor">&lt;/a>3. Deployments
&lt;/h2>&lt;ul>
&lt;li>rolling updates&lt;/li>
&lt;li>rolling back&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/core_concepts-1.png"
loading="lazy"
alt="img-1"
>&lt;/p>
&lt;h2 id="4-namespaces">&lt;a href="#4-namespaces" class="header-anchor">&lt;/a>4. Namespaces
&lt;/h2>&lt;ul>
&lt;li>user의 실수부터 보호하기 위해서 처음 3개의 namespace가 생성됨
&lt;ul>
&lt;li>Default&lt;/li>
&lt;li>kube-system&lt;/li>
&lt;li>kube-public&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>isolate resources between namespace&lt;/li>
&lt;li>own policies
&lt;ul>
&lt;li>each namespace is guaranteed certain amount and does not to use more.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>to reach in same namespace
&lt;ul>
&lt;li>&lt;code>mysql.connect(&amp;quot;db-service&amp;quot;)&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>to reach in other namespace
&lt;ul>
&lt;li>&lt;code>mysql.connect(db-service.dev.svc.cluster.local)&lt;/code>&lt;/li>
&lt;li>&lt;code>{service-name}.{namespace}.{service}-{domain-name}&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="생성-2">&lt;a href="#%ec%83%9d%ec%84%b1-2" class="header-anchor">&lt;/a>생성
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">k create ns dev-ns
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">namespace/dev-ns created
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="목록">&lt;a href="#%eb%aa%a9%eb%a1%9d" class="header-anchor">&lt;/a>목록
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k get ns
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">default Active 88s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dev Active 34s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">finance Active 34s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-node-lease Active 93s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-public Active 94s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system Active 95s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">manufacturing Active 33s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">marketing Active 34s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">prod Active 33s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">research Active 33s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="상태-2">&lt;a href="#%ec%83%81%ed%83%9c-2" class="header-anchor">&lt;/a>상태
&lt;/h3>&lt;ol>
&lt;li>&lt;code>--namespace&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl get pods --namespace&lt;span class="o">=&lt;/span>kube-system
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>&lt;code>-n&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl get pods -n kube-system
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h3 id="change-default">&lt;a href="#change-default" class="header-anchor">&lt;/a>change default
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl config set-context &lt;span class="k">$(&lt;/span>kubectl config current-context&lt;span class="k">)&lt;/span> --namespace&lt;span class="o">=&lt;/span>dev
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="pod-생성">&lt;a href="#pod-%ec%83%9d%ec%84%b1" class="header-anchor">&lt;/a>pod 생성
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">k run redis --image&lt;span class="o">=&lt;/span>redis --namespace&lt;span class="o">=&lt;/span>finance
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/redis created
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="전체-확인">&lt;a href="#%ec%a0%84%ec%b2%b4-%ed%99%95%ec%9d%b8" class="header-anchor">&lt;/a>전체 확인
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">k get po --all-namespaces
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>
&lt;p>하나의 값만 찾고 싶을 때&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">k get po --all-namespaces &lt;span class="p">|&lt;/span> grep -i blue
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="5-services">&lt;a href="#5-services" class="header-anchor">&lt;/a>5. Services
&lt;/h2>&lt;p>allow to communicate w\ people, backend, frontend, extra data source&lt;/p>
&lt;p>&lt;strong>types&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>node port
&lt;ul>
&lt;li>make an internal pod accessible on a port on node&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>cluster ip
&lt;ul>
&lt;li>creates a virtual IP inside the cluster to enable communication b2n different services&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>load balancer
&lt;ul>
&lt;li>provisions a load balancer for service for cloud provider&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>NodePort&lt;/strong>&lt;/p>
&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/core_concepts-2.png"
loading="lazy"
alt="img-2"
>&lt;/p>
&lt;ul>
&lt;li>target port&lt;/li>
&lt;li>port
&lt;ul>
&lt;li>port of service itself&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>node port
&lt;ul>
&lt;li>valid range: 30000 ~ 32767&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">SErvice&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">myapp-service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">NodePort&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">targetPort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">nodePort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">30008&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>if &lt;code>targetPort&lt;/code> is not given
&lt;ul>
&lt;li>same as &lt;code>port&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>if &lt;code>nodePort&lt;/code> is not given
&lt;ul>
&lt;li>automatically allocated&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>randomly distributed if same port is exists&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>ClusterIP&lt;/strong>
&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/core_concepts-3.png"
loading="lazy"
alt="img-3"
>&lt;/p>
&lt;p>&lt;strong>LoadBalancer&lt;/strong>&lt;/p>
&lt;h3 id="상태-3">&lt;a href="#%ec%83%81%ed%83%9c-3" class="header-anchor">&lt;/a>상태
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; k get svc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME TYPE CLUSTER-IP EXTERNAL-IP PORT&lt;span class="o">(&lt;/span>S&lt;span class="o">)&lt;/span> AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubernetes ClusterIP 10.96.0.1 &amp;lt;none&amp;gt; 443/TCP 3m46s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="명령어">&lt;a href="#%eb%aa%85%eb%a0%b9%ec%96%b4" class="header-anchor">&lt;/a>명령어
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; kubectl expose pod redis --port&lt;span class="o">=&lt;/span>&lt;span class="m">6379&lt;/span> --name redis-service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="expose">&lt;a href="#expose" class="header-anchor">&lt;/a>expose
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt; kubectl run custom-nginx --image&lt;span class="o">=&lt;/span>nginx --port&lt;span class="o">=&lt;/span>&lt;span class="m">8080&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl run httpd --image&lt;span class="o">=&lt;/span>httpd:alpine --port&lt;span class="o">=&lt;/span>&lt;span class="m">80&lt;/span> --expose
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="6-imperative-vs-declaritive">&lt;a href="#6-imperative-vs-declaritive" class="header-anchor">&lt;/a>6. Imperative vs Declaritive
&lt;/h2>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/core_concepts-4.png"
loading="lazy"
alt="img-4"
>&lt;/p>
&lt;h3 id="infrastructure-as-code">&lt;a href="#infrastructure-as-code" class="header-anchor">&lt;/a>Infrastructure as Code
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/core_concepts-5.png"
loading="lazy"
alt="img-5"
>&lt;/p>
&lt;h3 id="kubernetes">&lt;a href="#kubernetes" class="header-anchor">&lt;/a>Kubernetes
&lt;/h3>&lt;p>&lt;img src="https://aiden-jeon.github.io/blog/imgs/cka/core_concepts-6.png"
loading="lazy"
alt="img-6"
>
&lt;strong>Imperative Commands&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>create objects&lt;/li>
&lt;li>update objects
→ hard to keep track&lt;/li>
&lt;/ul>
&lt;p>Imperative Configuration Files&lt;/p>
&lt;ul>
&lt;li>create objects
&lt;ul>
&lt;li>&lt;code>kubectl create -f ~.yaml&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>update obejcts
&lt;ul>
&lt;li>&lt;code>kubectl edit ~~ ~~&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl replace -f ~.yaml&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Declaritve&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>create objects
&lt;ul>
&lt;li>&lt;code>kubectl apply -f ~.yaml&lt;/code>&lt;/li>
&lt;li>&lt;code>kubectl apply -f /path/to/config-files&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>update objects
&lt;ul>
&lt;li>&lt;code>kubectl apply -f ~.yaml&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item></channel></rss>